{
  "hash": "2e3978eca7b6163854450e947f347020",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: 'LAB: Linear Regression on Whiteside data'\ndate: \"2025-02-23 22:11:59.466669\"\ndraft: false \n\nexecute:\n  echo: true\n  eval: true\n  collapse: true\n\n\nformat:\n  html:\n    output-file: lab-linear-regression-whiteside.html\n  pdf:\n    output-file: lab-linear-regression-whiteside.pdf\n\n\n---\n\n\n\n\n::: {layout=\"[80,20]\"}\n\n::: {#first-column}\n\n|                            |\n|:---------------------------|\n| {{< var curriculum >}}     |\n| {{< var university >}}     |\n| Année {{< var year >}}     |\n| {{< var homepage >}}       |\n| {{< var moodle >}}         |\n\n\n::: \n\n::: {#second-column}\n![](/images/UniversiteParis_monogramme_couleur_RVB.png){align=\"right\" style=\"size:50px;\" width=75}\n:::\n\n:::\n\n\n\n\n\n\n## Introduction\n\nThe purpose of this lab is to introduce *linear regression* using base `R` and the tidyverse. \nWe work on a dataset provided by the [MASS](https://www.stats.ox.ac.uk/pub/MASS4/) package.\nThis dataset is investigated in the book by Venables and Ripley. This discusssion is  worth being read. Our aim is to relate regression as a tool for data exploration with regression as a method in statistical inference. To perform regression, we will rely on the base `R` function  `lm()` and on the eponymous S3 class `lm`. We will spend time understanding how the *formula* argument can be used to  construct a *design matrix* from a dataframe representing a dataset.  \n\n\n\n## Packages installation and loading  (again)\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# We will use the following packages. \n# If needed, install them : pak::pkg_install(). \nstopifnot(\n  require(\"magrittr\"),\n  require(\"lobstr\"),\n  require(\"ggforce\"),\n  require(\"patchwork\"), \n  require(\"gt\"),\n  require(\"glue\"),\n  require(\"skimr\"),\n  require(\"corrr\"),\n  require(\"GGally\"),\n  require(\"broom\"),\n  require(\"tidyverse\")\n)\n```\n:::\n\n\n\n\nBesides the `tidyverse`, we rely on `skimr` to perform univariate analysis, `GGally::ggpairs` to perform pairwise (bivariate) analysis. Package `corrr` provide graphical tools to explore correlation matrices.\nAt some point, we will showcase the exposing pipe `%$%` and the classical pipe `%>%` of `magrittr`. We use `gt` to display handy tables, `patchwork` to compose graphical objects. `glue` provides a kind of formatted strings. Package `broom` proves very useful when milking lienar models produced by `lm()` (and many other objects produced by estimators, tests, ...)   \n\n\n\n\n\n\n\n\n\n\n\n# Dataset\n\nThe dataset is available from package `MASS`. `MASS` can be downloaded from `cran`.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwhiteside <- MASS::whiteside # no need to load the whole package\n\ncur_dataset <- str_to_title(as.character(substitute(whiteside)))\n# ?whiteside\n```\n:::\n\n\n\n\nThe documentation of `R` tells us a little bit more about this data set. \n\n> Mr Derek Whiteside of the UK Building Research Station recorded the weekly gas consumption and average external temperature at his own house in south-east England for two heating seasons, one of 26 weeks before, and one of 30 weeks after cavity-wall insulation was installed. The object of the exercise was to assess the effect of the insulation on gas consumption.\n\nThis means that our sample is  made of 56 observations. Each observation corresponds to a week during heating season. For each observation. We have the average external temperature `Temp` (in degrees Celsius) and the weekly gas consumption `Gas`. We also have `Insul` which tells us whether the observation has been recorded `Before` or `After` treatment.  \n\nTemperature is the *explanatory* variable or the *covariate*. The target/response is the weekly Gas Consumption. We aim to *predict* or to *explain* the variations of weekly gas consumption as a function average weekly temperature. \n\nThe question is wether  the  treatment (insulation) modifies the relation between gas consumption and external temperature, and if we conclude that the treatment modifies the relation, in which way?.\n\nHave a glimpse at the data. \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwhiteside %>% \n  glimpse\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 56\nColumns: 3\n$ Insul <fct> Before, Before, Before, Before, Before, Before, Before, Before, …\n$ Temp  <dbl> -0.8, -0.7, 0.4, 2.5, 2.9, 3.2, 3.6, 3.9, 4.2, 4.3, 5.4, 6.0, 6.…\n$ Gas   <dbl> 7.2, 6.9, 6.4, 6.0, 5.8, 5.8, 5.6, 4.7, 5.8, 5.2, 4.9, 4.9, 4.3,…\n```\n\n\n:::\n:::\n\n\n\n\nEven though the experimenter, Mr Whiteside, decided to apply a *treatment* to his house. This is not exactly what we call *experimental data*.  Namely, the experimenter has no way to clamp the external temperature. \nWith respect to the Temperature variable (the explanatory variable) we are facing *observational* data.\n\n\n\n\n# Columnwise exploration\n\n\n::: {.callout-note title=\"Question\"}\n\nBefore before proceeding to linear regressions of `Gas` with respect to `Temp`, perform univariate analysis on each variable.  \n\n- Compute summary statistics\n- Build the corresponding plots\n  \n:::\n\n::: {.content-visible when-profile='solution'} \n\n::: {.callout-tip title=\"Solution\"}\n\n\n`skimr` does the job.  There are no missing data, complete rate is always `1`, we remove non-informative \ncolumns from the output. \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwhiteside |>\n  skimr::skim() |>\n  select(-n_missing, -complete_rate, -factor.ordered, - factor.n_unique) |>\n  gt() |>\n  gt::fmt_number(decimals=1) |>\n  gt::tab_caption(\"Whiteside dataset. Columnwise summaries\")\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"eiulrqzqpa\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#eiulrqzqpa table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#eiulrqzqpa thead, #eiulrqzqpa tbody, #eiulrqzqpa tfoot, #eiulrqzqpa tr, #eiulrqzqpa td, #eiulrqzqpa th {\n  border-style: none;\n}\n\n#eiulrqzqpa p {\n  margin: 0;\n  padding: 0;\n}\n\n#eiulrqzqpa .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#eiulrqzqpa .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#eiulrqzqpa .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#eiulrqzqpa .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#eiulrqzqpa .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#eiulrqzqpa .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#eiulrqzqpa .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#eiulrqzqpa .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#eiulrqzqpa .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#eiulrqzqpa .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#eiulrqzqpa .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#eiulrqzqpa .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#eiulrqzqpa .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#eiulrqzqpa .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#eiulrqzqpa .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#eiulrqzqpa .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#eiulrqzqpa .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#eiulrqzqpa .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#eiulrqzqpa .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#eiulrqzqpa .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#eiulrqzqpa .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#eiulrqzqpa .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#eiulrqzqpa .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#eiulrqzqpa .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#eiulrqzqpa .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#eiulrqzqpa .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#eiulrqzqpa .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#eiulrqzqpa .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#eiulrqzqpa .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#eiulrqzqpa .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#eiulrqzqpa .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#eiulrqzqpa .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#eiulrqzqpa .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#eiulrqzqpa .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#eiulrqzqpa .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#eiulrqzqpa .gt_left {\n  text-align: left;\n}\n\n#eiulrqzqpa .gt_center {\n  text-align: center;\n}\n\n#eiulrqzqpa .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#eiulrqzqpa .gt_font_normal {\n  font-weight: normal;\n}\n\n#eiulrqzqpa .gt_font_bold {\n  font-weight: bold;\n}\n\n#eiulrqzqpa .gt_font_italic {\n  font-style: italic;\n}\n\n#eiulrqzqpa .gt_super {\n  font-size: 65%;\n}\n\n#eiulrqzqpa .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#eiulrqzqpa .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#eiulrqzqpa .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#eiulrqzqpa .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#eiulrqzqpa .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#eiulrqzqpa .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#eiulrqzqpa .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#eiulrqzqpa .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#eiulrqzqpa div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <caption>Whiteside dataset. Columnwise summaries</caption>\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"skim_type\">skim_type</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"skim_variable\">skim_variable</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"factor.top_counts\">factor.top_counts</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"numeric.mean\">numeric.mean</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"numeric.sd\">numeric.sd</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"numeric.p0\">numeric.p0</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"numeric.p25\">numeric.p25</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"numeric.p50\">numeric.p50</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"numeric.p75\">numeric.p75</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"numeric.p100\">numeric.p100</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"numeric.hist\">numeric.hist</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"skim_type\" class=\"gt_row gt_left\">factor</td>\n<td headers=\"skim_variable\" class=\"gt_row gt_left\">Insul</td>\n<td headers=\"factor.top_counts\" class=\"gt_row gt_left\">Aft: 30, Bef: 26</td>\n<td headers=\"numeric.mean\" class=\"gt_row gt_right\">NA</td>\n<td headers=\"numeric.sd\" class=\"gt_row gt_right\">NA</td>\n<td headers=\"numeric.p0\" class=\"gt_row gt_right\">NA</td>\n<td headers=\"numeric.p25\" class=\"gt_row gt_right\">NA</td>\n<td headers=\"numeric.p50\" class=\"gt_row gt_right\">NA</td>\n<td headers=\"numeric.p75\" class=\"gt_row gt_right\">NA</td>\n<td headers=\"numeric.p100\" class=\"gt_row gt_right\">NA</td>\n<td headers=\"numeric.hist\" class=\"gt_row gt_left\">NA</td></tr>\n    <tr><td headers=\"skim_type\" class=\"gt_row gt_left\">numeric</td>\n<td headers=\"skim_variable\" class=\"gt_row gt_left\">Temp</td>\n<td headers=\"factor.top_counts\" class=\"gt_row gt_left\">NA</td>\n<td headers=\"numeric.mean\" class=\"gt_row gt_right\">4.9</td>\n<td headers=\"numeric.sd\" class=\"gt_row gt_right\">2.7</td>\n<td headers=\"numeric.p0\" class=\"gt_row gt_right\">−0.8</td>\n<td headers=\"numeric.p25\" class=\"gt_row gt_right\">3.1</td>\n<td headers=\"numeric.p50\" class=\"gt_row gt_right\">4.9</td>\n<td headers=\"numeric.p75\" class=\"gt_row gt_right\">7.1</td>\n<td headers=\"numeric.p100\" class=\"gt_row gt_right\">10.2</td>\n<td headers=\"numeric.hist\" class=\"gt_row gt_left\">▃▅▇▇▃</td></tr>\n    <tr><td headers=\"skim_type\" class=\"gt_row gt_left\">numeric</td>\n<td headers=\"skim_variable\" class=\"gt_row gt_left\">Gas</td>\n<td headers=\"factor.top_counts\" class=\"gt_row gt_left\">NA</td>\n<td headers=\"numeric.mean\" class=\"gt_row gt_right\">4.1</td>\n<td headers=\"numeric.sd\" class=\"gt_row gt_right\">1.2</td>\n<td headers=\"numeric.p0\" class=\"gt_row gt_right\">1.3</td>\n<td headers=\"numeric.p25\" class=\"gt_row gt_right\">3.5</td>\n<td headers=\"numeric.p50\" class=\"gt_row gt_right\">4.0</td>\n<td headers=\"numeric.p75\" class=\"gt_row gt_right\">4.6</td>\n<td headers=\"numeric.p100\" class=\"gt_row gt_right\">7.2</td>\n<td headers=\"numeric.hist\" class=\"gt_row gt_left\">▁▆▇▂▁</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n\nAn  alternative way of doing this univariate  analysis consists in separating categorical variables from numerical ones. \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsk <- whiteside %>% \n  skimr::skim() %>% \n  select(-n_missing, - complete_rate, -factor.ordered, - factor.n_unique)\n\nskimr::yank(sk, \"factor\") |> \n  gt() |>\n  gt::tab_caption(\"Whiteside dataset. Categorical variables summaries\")\n\n\nskimr::yank(sk, \"numeric\") |> \n  gt() |>\n  gt::fmt_number(decimals=1) |>\n  gt::tab_caption(\"Whiteside dataset. Categorical variables summaries\")\n```\n:::\n\n\n\n\nWe may test the normality of the `Gas`  and `Temp`  distribution\n\n\n\n\n::: {.cell appendix='true'}\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"gpbxbhvpni\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#gpbxbhvpni table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#gpbxbhvpni thead, #gpbxbhvpni tbody, #gpbxbhvpni tfoot, #gpbxbhvpni tr, #gpbxbhvpni td, #gpbxbhvpni th {\n  border-style: none;\n}\n\n#gpbxbhvpni p {\n  margin: 0;\n  padding: 0;\n}\n\n#gpbxbhvpni .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#gpbxbhvpni .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#gpbxbhvpni .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#gpbxbhvpni .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#gpbxbhvpni .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#gpbxbhvpni .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#gpbxbhvpni .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#gpbxbhvpni .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#gpbxbhvpni .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#gpbxbhvpni .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#gpbxbhvpni .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#gpbxbhvpni .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#gpbxbhvpni .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#gpbxbhvpni .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#gpbxbhvpni .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#gpbxbhvpni .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#gpbxbhvpni .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#gpbxbhvpni .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#gpbxbhvpni .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#gpbxbhvpni .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#gpbxbhvpni .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#gpbxbhvpni .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#gpbxbhvpni .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#gpbxbhvpni .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#gpbxbhvpni .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#gpbxbhvpni .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#gpbxbhvpni .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#gpbxbhvpni .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#gpbxbhvpni .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#gpbxbhvpni .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#gpbxbhvpni .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#gpbxbhvpni .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#gpbxbhvpni .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#gpbxbhvpni .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#gpbxbhvpni .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#gpbxbhvpni .gt_left {\n  text-align: left;\n}\n\n#gpbxbhvpni .gt_center {\n  text-align: center;\n}\n\n#gpbxbhvpni .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#gpbxbhvpni .gt_font_normal {\n  font-weight: normal;\n}\n\n#gpbxbhvpni .gt_font_bold {\n  font-weight: bold;\n}\n\n#gpbxbhvpni .gt_font_italic {\n  font-style: italic;\n}\n\n#gpbxbhvpni .gt_super {\n  font-size: 65%;\n}\n\n#gpbxbhvpni .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#gpbxbhvpni .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#gpbxbhvpni .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#gpbxbhvpni .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#gpbxbhvpni .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#gpbxbhvpni .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#gpbxbhvpni .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#gpbxbhvpni .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#gpbxbhvpni div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Var\">Var</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"statistic\">statistic</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"p.value\">p.value</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"method\">method</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"Var\" class=\"gt_row gt_left\">Temp</td>\n<td headers=\"statistic\" class=\"gt_row gt_right\">0.98</td>\n<td headers=\"p.value\" class=\"gt_row gt_right\">0.48</td>\n<td headers=\"method\" class=\"gt_row gt_left\">Shapiro-Wilk normality test</td></tr>\n    <tr><td headers=\"Var\" class=\"gt_row gt_left\">Gas</td>\n<td headers=\"statistic\" class=\"gt_row gt_right\">0.96</td>\n<td headers=\"p.value\" class=\"gt_row gt_right\">0.08</td>\n<td headers=\"method\" class=\"gt_row gt_left\">Shapiro-Wilk normality test</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n\nBoth variables pass the Shapiro-Wilk test with flying colors. \n\nWe may use the Jarque-Bera test [See R bloggers on this](https://www.r-bloggers.com/2021/08/goodness-of-fit-test-jarque-bera-test-in-r/)\n\n\n\n\n::: {.cell appendix='true'}\n::: {.cell-output .cell-output-stderr}\n\n```\nRegistered S3 method overwritten by 'quantmod':\n  method            from\n  as.zoo.data.frame zoo \n```\n\n\n:::\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"ewewvxvrrc\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#ewewvxvrrc table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#ewewvxvrrc thead, #ewewvxvrrc tbody, #ewewvxvrrc tfoot, #ewewvxvrrc tr, #ewewvxvrrc td, #ewewvxvrrc th {\n  border-style: none;\n}\n\n#ewewvxvrrc p {\n  margin: 0;\n  padding: 0;\n}\n\n#ewewvxvrrc .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#ewewvxvrrc .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#ewewvxvrrc .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#ewewvxvrrc .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#ewewvxvrrc .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ewewvxvrrc .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ewewvxvrrc .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ewewvxvrrc .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#ewewvxvrrc .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#ewewvxvrrc .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#ewewvxvrrc .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#ewewvxvrrc .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#ewewvxvrrc .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#ewewvxvrrc .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#ewewvxvrrc .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#ewewvxvrrc .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#ewewvxvrrc .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#ewewvxvrrc .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#ewewvxvrrc .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ewewvxvrrc .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#ewewvxvrrc .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#ewewvxvrrc .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#ewewvxvrrc .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ewewvxvrrc .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#ewewvxvrrc .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#ewewvxvrrc .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ewewvxvrrc .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ewewvxvrrc .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#ewewvxvrrc .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ewewvxvrrc .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#ewewvxvrrc .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ewewvxvrrc .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ewewvxvrrc .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ewewvxvrrc .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ewewvxvrrc .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ewewvxvrrc .gt_left {\n  text-align: left;\n}\n\n#ewewvxvrrc .gt_center {\n  text-align: center;\n}\n\n#ewewvxvrrc .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#ewewvxvrrc .gt_font_normal {\n  font-weight: normal;\n}\n\n#ewewvxvrrc .gt_font_bold {\n  font-weight: bold;\n}\n\n#ewewvxvrrc .gt_font_italic {\n  font-style: italic;\n}\n\n#ewewvxvrrc .gt_super {\n  font-size: 65%;\n}\n\n#ewewvxvrrc .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#ewewvxvrrc .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#ewewvxvrrc .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#ewewvxvrrc .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#ewewvxvrrc .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#ewewvxvrrc .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#ewewvxvrrc .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#ewewvxvrrc .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#ewewvxvrrc div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <caption>Whiteside dataset</caption>\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Var\">Var</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"statistic\">statistic</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"p.value\">p.value</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"parameter\">parameter</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"method\">method</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"Var\" class=\"gt_row gt_left\">Temp</td>\n<td headers=\"statistic\" class=\"gt_row gt_right\">1.37</td>\n<td headers=\"p.value\" class=\"gt_row gt_right\">0.50</td>\n<td headers=\"parameter\" class=\"gt_row gt_right\">2.00</td>\n<td headers=\"method\" class=\"gt_row gt_left\">Jarque Bera Test</td></tr>\n    <tr><td headers=\"Var\" class=\"gt_row gt_left\">Gas</td>\n<td headers=\"statistic\" class=\"gt_row gt_right\">2.74</td>\n<td headers=\"p.value\" class=\"gt_row gt_right\">0.25</td>\n<td headers=\"parameter\" class=\"gt_row gt_right\">2.00</td>\n<td headers=\"method\" class=\"gt_row gt_left\">Jarque Bera Test</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n\nBoth variables also pass the Jarque-Bera test with flying colors. This is noteworthy \nsince the Jarque-Bera compares empirical skewness and kurtosis to Gaussian skewness and kurtosis. \n\n\n:::\n\n:::\n\n# Pairwise exploration\n\n::: {.callout-note title=\"Question\"}\n\nCompare distributions of numeric variables with respect to categorical variable `Insul`\n\n:::\n\n\n::: {.content-visible when-profile='solution'} \n \n::: {.callout-tip title=\"Solution\"}\n\nWe start by plotting histograms \n\nTo abide to the DRY principle,  we take \nadvantage of the fact that aesthetics and labels can be tuned incrementally. \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\np_xx <- whiteside |>\n    ggplot() +\n      geom_histogram(\n        mapping=aes(fill=Insul, color=Insul, y=after_stat(density)),\n        position=\"dodge\",\n        alpha=.1,\n        bins=10) \n\np_1 <- p_xx + \n  aes(x=Temp)  +\n  theme(legend.position = \"None\")+\n  labs(title=\"External Temperature\",\n       subtitle = \"Weekly Average (Celsius)\")\n\np_2 <- p_xx + \n  aes(x=Gas)  +\n  labs(title=\"Gas Consumption\" ,\n       subtitle=\"Weekly Average\")\n\n# patchwork the two graphical objects \n(p_1 + p_2) +\n  patchwork::plot_annotation(\n    caption=\"Whiteside dataset from package MASS\"\n  )\n```\n\n::: {.cell-output-display}\n![](lab-linear-regression-whiteside_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n\n\nNote the `position` parameter for `geom_histogram()`. Check the result for `position=\"stack\"`, `position=\"identity\"`. Make up your mind about the most convenient choice.\n\nGas Consumption distribution `After` looks shifted with respect to distribution `Before`.\n\nAnother visualization strategy consists in using the faceting mechanism\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nr <- whiteside %>% \n  pivot_longer(cols=c(Gas, Temp),\n              names_to = \"Vars\",\n              values_to = \"Vals\") %>% \n  ggplot() +\n  aes(x=Vals)  +\n  facet_wrap(~ Insul + Vars ) + \n  xlab(\"\")\n\nr +\n  aes(y=after_stat(density)) +\n  geom_histogram(alpha=.3, fill=\"white\", color=\"black\", bins=6) +\n  ggtitle(glue(\"{cur_dataset} data\"))\n```\n\n::: {.cell-output-display}\n![](lab-linear-regression-whiteside_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\n\n:::\n\n:::\n\n\n# Covariance and correlation between `Gas` and `Temp`\n\n\n::: {.callout-note title=\"Question\"}\n\nCompute the covariance matrix of `Gas` and `Temp`\n\n:::\n\n::::: {.content-visible when-profile=\"solution\"}  \n\n::: {.callout-tip title=\"Solution\"}\n\n\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmu_n <- whiteside %>% \n  select(where(is.numeric)) %>% \n  colMeans()\n```\n:::\n\n\n\n\n\n\n\n$$\nC_n = \\begin{bmatrix}\n7.56 & -2.19\\\\\n-2.19 & 1.36\n\\end{bmatrix} \\qquad \\mu_n = \\begin{bmatrix}\n4.88\\\\\n4.07\n\\end{bmatrix}\n$$\n:::\n\n:::::\n\n\n::: {.content-visible when-profile=\"solution\"}\n\n::: {.callout-tip title=\"Solution\"}\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Compute the covariance matrix for Gas and Temp\nC <- whiteside |>\n  select(where(is.numeric)) |> \n  cov()\n```\n:::\n\n\n\n\n\nComputing correlations and correlations per groups is revealing. \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# use magrittr pipe %>%  to define a pipeline function\nmy_cor <-  . %>% \n  summarize(\n    pearson= cor(Temp, Gas, method=\"pearson\"),\n    kendall=cor(Temp, Gas, method=\"kendall\"),\n    spearman=cor(Temp,Gas, method=\"spearman\")\n  ) \n\nt1 <- whiteside |>\n  group_by(Insul) |> \n  my_cor()\n\n\nt2 <- whiteside |>\n  my_cor() |>\n  mutate(Insul=\"pooled\")\n\nbind_rows(t1, t2)  |> \n    gt() |>\n    gt::fmt_number(decimals=2) |>\n    gt::tab_caption(\"Whiteside data: correlations between Gas and Temp\")\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"cxbmqhensx\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#cxbmqhensx table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#cxbmqhensx thead, #cxbmqhensx tbody, #cxbmqhensx tfoot, #cxbmqhensx tr, #cxbmqhensx td, #cxbmqhensx th {\n  border-style: none;\n}\n\n#cxbmqhensx p {\n  margin: 0;\n  padding: 0;\n}\n\n#cxbmqhensx .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#cxbmqhensx .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#cxbmqhensx .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#cxbmqhensx .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#cxbmqhensx .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#cxbmqhensx .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#cxbmqhensx .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#cxbmqhensx .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#cxbmqhensx .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#cxbmqhensx .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#cxbmqhensx .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#cxbmqhensx .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#cxbmqhensx .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#cxbmqhensx .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#cxbmqhensx .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#cxbmqhensx .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#cxbmqhensx .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#cxbmqhensx .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#cxbmqhensx .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#cxbmqhensx .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#cxbmqhensx .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#cxbmqhensx .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#cxbmqhensx .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#cxbmqhensx .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#cxbmqhensx .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#cxbmqhensx .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#cxbmqhensx .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#cxbmqhensx .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#cxbmqhensx .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#cxbmqhensx .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#cxbmqhensx .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#cxbmqhensx .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#cxbmqhensx .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#cxbmqhensx .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#cxbmqhensx .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#cxbmqhensx .gt_left {\n  text-align: left;\n}\n\n#cxbmqhensx .gt_center {\n  text-align: center;\n}\n\n#cxbmqhensx .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#cxbmqhensx .gt_font_normal {\n  font-weight: normal;\n}\n\n#cxbmqhensx .gt_font_bold {\n  font-weight: bold;\n}\n\n#cxbmqhensx .gt_font_italic {\n  font-style: italic;\n}\n\n#cxbmqhensx .gt_super {\n  font-size: 65%;\n}\n\n#cxbmqhensx .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#cxbmqhensx .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#cxbmqhensx .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#cxbmqhensx .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#cxbmqhensx .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#cxbmqhensx .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#cxbmqhensx .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#cxbmqhensx .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#cxbmqhensx div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <caption>Whiteside data: correlations between Gas and Temp</caption>\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Insul\">Insul</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"pearson\">pearson</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"kendall\">kendall</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"spearman\">spearman</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"Insul\" class=\"gt_row gt_left\">Before</td>\n<td headers=\"pearson\" class=\"gt_row gt_right\">−0.97</td>\n<td headers=\"kendall\" class=\"gt_row gt_right\">−0.85</td>\n<td headers=\"spearman\" class=\"gt_row gt_right\">−0.96</td></tr>\n    <tr><td headers=\"Insul\" class=\"gt_row gt_left\">After</td>\n<td headers=\"pearson\" class=\"gt_row gt_right\">−0.90</td>\n<td headers=\"kendall\" class=\"gt_row gt_right\">−0.72</td>\n<td headers=\"spearman\" class=\"gt_row gt_right\">−0.86</td></tr>\n    <tr><td headers=\"Insul\" class=\"gt_row gt_left\">pooled</td>\n<td headers=\"pearson\" class=\"gt_row gt_right\">−0.68</td>\n<td headers=\"kendall\" class=\"gt_row gt_right\">−0.47</td>\n<td headers=\"spearman\" class=\"gt_row gt_right\">−0.62</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n\nNote the sharp increase of all correlation coefficients we data are grouped according to the control/treatment variable (`Insul`).\n\nUse `ggpairs` from `GGally` to get a quick overview of the pairwise interactions.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwhiteside |>\n  GGally::ggpairs()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](lab-linear-regression-whiteside_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n\n\n\n\n:::\n\n:::\n\n\n::: {.callout-note title=\"Question\"}\n\nBuild a scatterplot of the Whiteside dataset\n\n\n:::\n\n::: {.content-visible when-profile=\"solution\"}\n\n::: {.callout-tip title=\"Solution\"}\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\np <- whiteside %>% \n  ggplot() +\n  aes(x=Temp, y=Gas) +\n  geom_point(aes(shape=Insul)) +\n  xlab(\"Average Weekly Temperature (Celsius)\") +\n  ylab(\"Average Weekly Gas Consumption 1000 cube feet\") +\n  labs(\n    ## Use list unpacking\n  )\n\np + \n  ggtitle(glue(\"{cur_dataset} dataset\"))\n```\n\n::: {.cell-output-display}\n![](lab-linear-regression-whiteside_files/figure-html/whiteside-scatter-1.png){width=672}\n:::\n:::\n\n\n\n\nNote that the dataset looks like the stacking of two bananas corresponding to the two heating seasons. \n:::\n\n:::\n\n::: {.callout-note title=\"Question\"} \n\nBuild boxplots of `Temp` and  `Gas` versus `Insul`\n\n:::\n\n::: {.content-visible when-profile=\"solution\"}\n\n::: {.callout-tip title=\"Solution\"}\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nq <- whiteside %>% \n  ggplot() +\n  aes(x=Insul)\n\nqt <- q + \n  geom_boxplot(aes(y=Temp))\n\nqg <- q + \n  geom_boxplot(aes(y=Gas))\n\n(qt + qg) +\n  patchwork::plot_annotation(title = glue(\"{cur_dataset} dataset\"))\n```\n\n::: {.cell-output-display}\n![](lab-linear-regression-whiteside_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\n\n\nNote the two low extremes/outliers for the Gas Consumption after Insulation.  \n\n:::\n\n:::\n\n::: {.callout-note title=\"Question\"}\n\nBuild violine plots  of `Temp` and `Gas` versus `Insul`\n\n:::\n\n\n::: {.content-visible when-profile=\"solution\"}\n\n::: {.callout-tip title=\"Solution\"}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n(q + \n  geom_violin(aes(y=Temp))) +\n(q + \n  geom_violin(aes(y=Gas))) +\n  patchwork::plot_annotation(title = glue(\"{cur_dataset} dataset\"))\n```\n\n::: {.cell-output-display}\n![](lab-linear-regression-whiteside_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n\n\n\n:::\n\n:::\n\n\n\n::: {.callout-note title=\"Question\"}\n\nPlot density estimates of  `Temp` and `Gas` versus `Insul`.\n\n:::\n\n::: {.content-visible when-profile=\"solution\"}\n\n::: {.callout-tip title=\"Solution\"}\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nr +\n  stat_density(alpha=.3 , \n               fill=\"grey\", \n               color=\"black\", \n#               bw = \"SJ\",\n               adjust = .5 ) +\n  ggtitle(glue(\"{cur_dataset} data\"))\n```\n\n::: {.cell-output-display}\n![](lab-linear-regression-whiteside_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n\n\n\n:::\n\n:::\n\n# Hand-made calculation of simple linear regression estimates for `Gas` versus `Temp`\n\n::: {.callout-note title=\"Question\"}\n\nCompute slope and intercept using elementary computations\n\n:::\n\n::: {.content-visible when-profile=\"solution\"}\n\n::: {.callout-tip title=\"Solution\"}\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nslope <- C[1,2] / C[1,1] # slope \n\nintercept <- whiteside %$%  # exposing pipe from magrittr\n  (mean(Gas) - slope * mean(Temp)) # intercept\n\n# with(whiteside,\n#     mean(Gas) - b * mean(Temp)) \n```\n:::\n\n\n\n\nIn simple linear regression, the slope follows from the covariance matrix \nin a straightforward way. The slope can also be expressed as the linear correlation coefficient (Pearson)  times the ration between the standard deviation of the response variable and the standard deviation of the explanatory variable. \n\n:::\n\n:::\n\n::: {.callout-note title=\"Question\"}\n\nOverlay the scatterplot with the regression line.\n\n:::\n\n::: {.content-visible when-profile=\"solution\"}\n\n::: {.callout-tip title=\"Solution\"}\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\np + \n  geom_abline(slope=slope, intercept = intercept) +\n  ggtitle(glue(\"{cur_dataset} data\"), subtitle = \"Least square regression line\")\n```\n\n::: {.cell-output-display}\n![](lab-linear-regression-whiteside_files/figure-html/unnamed-chunk-19-1.png){width=672}\n:::\n:::\n\n\n\n\n:::\n\n:::\n\n\n# Using `lm()`\n\n`lm` stands for Linear Models. Function `lm` has a number of arguments, including: \n\n- formula\n- data\n\n\n::: {.callout-note title=\"Question\"}\n\nUse `lm()` to compute slope and intercept\n\n:::\n\n::: {.content-visible when-profile=\"solution\"}\n\n::: {.callout-tip title=\"Solution\"}\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlm0 <- lm(Gas ~ Temp, data = whiteside)\n```\n:::\n\n\n\n\nThe result is an object of class `lm`. \n\nThe generic function `summary()` has a method for class `lm`\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlm0 %>% \n  summary()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = Gas ~ Temp, data = whiteside)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-1.6324 -0.7119 -0.2047  0.8187  1.5327 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)   5.4862     0.2357  23.275  < 2e-16 ***\nTemp         -0.2902     0.0422  -6.876 6.55e-09 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.8606 on 54 degrees of freedom\nMultiple R-squared:  0.4668,\tAdjusted R-squared:  0.457 \nF-statistic: 47.28 on 1 and 54 DF,  p-value: 6.545e-09\n```\n\n\n:::\n:::\n\n\n\n\nThe summary is made of four parts \n\n- The `call`. Very useful if we handle many different models (corresponding to different formulae, or different datasets)\n- A numerical summary of *residuals*\n- A commented display of the *estimated coefficients*\n- Estimate of *noise scale* (under Gaussian assumptions)\n- Squared linear correlation coefficient between response variable $Y$ (`Gas`) and predictions $\\widehat{Y}$\n- A test statistic (Fisher's statistic) for assessing null hypothesis that slope is null, and corresponding $p$-value (under Gaussian assumptions).\n\n:::\n\n:::\n\nIncluding a rough summary in a report is not always a good idea. It is easy to extract  tabular versions of the summary using functions `tidy()` and `glance()` from package `broom`. \n\nFor html output `gt::gt()` allows us to polish the final output\n\n\n::: {.content-visible when-profile=\"solution\"}\n\n::: {.callout-tip title=\"Solution\"}\n\nWe can use the exposing pipe from `magrittr` (or the `with` construct from base `R`) \nto build a function that extracts the coefficients estimates, standard error, $t$-statistic and associated p-values.  \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntidy_lm <- . %$% (    # <1>  The lhs is meant to be of class lm\n  tidy(.)  %>%         # <2> . acts as a pronoun for magrittr pipes     \n  gt::gt() %>% \n  gt::fmt_number(decimals=2) %>% \n  gt::tab_caption(glue(\"Linear regrression. Dataset: {call$data},  Formula: {deparse(call$formula)}\"))  # <3> call is evaluated as a member of the pronoun `.`\n)\n\ntidy_lm(lm0)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"cihcadintk\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#cihcadintk table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#cihcadintk thead, #cihcadintk tbody, #cihcadintk tfoot, #cihcadintk tr, #cihcadintk td, #cihcadintk th {\n  border-style: none;\n}\n\n#cihcadintk p {\n  margin: 0;\n  padding: 0;\n}\n\n#cihcadintk .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#cihcadintk .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#cihcadintk .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#cihcadintk .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#cihcadintk .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#cihcadintk .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#cihcadintk .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#cihcadintk .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#cihcadintk .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#cihcadintk .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#cihcadintk .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#cihcadintk .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#cihcadintk .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#cihcadintk .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#cihcadintk .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#cihcadintk .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#cihcadintk .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#cihcadintk .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#cihcadintk .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#cihcadintk .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#cihcadintk .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#cihcadintk .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#cihcadintk .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#cihcadintk .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#cihcadintk .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#cihcadintk .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#cihcadintk .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#cihcadintk .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#cihcadintk .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#cihcadintk .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#cihcadintk .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#cihcadintk .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#cihcadintk .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#cihcadintk .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#cihcadintk .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#cihcadintk .gt_left {\n  text-align: left;\n}\n\n#cihcadintk .gt_center {\n  text-align: center;\n}\n\n#cihcadintk .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#cihcadintk .gt_font_normal {\n  font-weight: normal;\n}\n\n#cihcadintk .gt_font_bold {\n  font-weight: bold;\n}\n\n#cihcadintk .gt_font_italic {\n  font-style: italic;\n}\n\n#cihcadintk .gt_super {\n  font-size: 65%;\n}\n\n#cihcadintk .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#cihcadintk .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#cihcadintk .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#cihcadintk .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#cihcadintk .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#cihcadintk .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#cihcadintk .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#cihcadintk .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#cihcadintk div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <caption>Linear regrression. Dataset: whiteside,  Formula: Gas ~ Temp</caption>\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"term\">term</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"estimate\">estimate</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"std.error\">std.error</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"statistic\">statistic</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"p.value\">p.value</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"term\" class=\"gt_row gt_left\">(Intercept)</td>\n<td headers=\"estimate\" class=\"gt_row gt_right\">5.49</td>\n<td headers=\"std.error\" class=\"gt_row gt_right\">0.24</td>\n<td headers=\"statistic\" class=\"gt_row gt_right\">23.28</td>\n<td headers=\"p.value\" class=\"gt_row gt_right\">0.00</td></tr>\n    <tr><td headers=\"term\" class=\"gt_row gt_left\">Temp</td>\n<td headers=\"estimate\" class=\"gt_row gt_right\">−0.29</td>\n<td headers=\"std.error\" class=\"gt_row gt_right\">0.04</td>\n<td headers=\"statistic\" class=\"gt_row gt_right\">−6.88</td>\n<td headers=\"p.value\" class=\"gt_row gt_right\">0.00</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n\n`deparse()` is an important function from base `R`. It is very helpful when trying to take advantage \nof lazy evaluation mechanisms. \n\n\nTODO: more on `glue()` \n\n:::\n\n:::\n\n::: {.callout-note title=\"Question\"}\n\nFunction `glance()` extract informations that can be helpful when performing model/variable selection. \n\n:::\n\n\n::: {.content-visible when-profile=\"solution\"}\n\n::: {.callout-tip title=\"Solution\"}\n\nThe next chunk handles several other parts of the summary. \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglance_lm <-  . %$% (\n  glance(.) %>% \n  mutate(across(-c(p.value), \n                ~ round(.x, digits=2)),\n         p.value=signif(p.value,3)) %>% \n  gt::gt() %>% \n  gt::tab_caption(glue(\"Dataset: {call$data},  Formula: {deparse(call$formula)}\"))\n)\n\nglance_lm(lm0)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"ltwbesbpnr\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#ltwbesbpnr table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#ltwbesbpnr thead, #ltwbesbpnr tbody, #ltwbesbpnr tfoot, #ltwbesbpnr tr, #ltwbesbpnr td, #ltwbesbpnr th {\n  border-style: none;\n}\n\n#ltwbesbpnr p {\n  margin: 0;\n  padding: 0;\n}\n\n#ltwbesbpnr .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#ltwbesbpnr .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#ltwbesbpnr .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#ltwbesbpnr .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#ltwbesbpnr .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ltwbesbpnr .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ltwbesbpnr .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ltwbesbpnr .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#ltwbesbpnr .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#ltwbesbpnr .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#ltwbesbpnr .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#ltwbesbpnr .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#ltwbesbpnr .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#ltwbesbpnr .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#ltwbesbpnr .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#ltwbesbpnr .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#ltwbesbpnr .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#ltwbesbpnr .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#ltwbesbpnr .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ltwbesbpnr .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#ltwbesbpnr .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#ltwbesbpnr .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#ltwbesbpnr .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ltwbesbpnr .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#ltwbesbpnr .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#ltwbesbpnr .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ltwbesbpnr .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ltwbesbpnr .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#ltwbesbpnr .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ltwbesbpnr .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#ltwbesbpnr .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ltwbesbpnr .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ltwbesbpnr .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ltwbesbpnr .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ltwbesbpnr .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ltwbesbpnr .gt_left {\n  text-align: left;\n}\n\n#ltwbesbpnr .gt_center {\n  text-align: center;\n}\n\n#ltwbesbpnr .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#ltwbesbpnr .gt_font_normal {\n  font-weight: normal;\n}\n\n#ltwbesbpnr .gt_font_bold {\n  font-weight: bold;\n}\n\n#ltwbesbpnr .gt_font_italic {\n  font-style: italic;\n}\n\n#ltwbesbpnr .gt_super {\n  font-size: 65%;\n}\n\n#ltwbesbpnr .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#ltwbesbpnr .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#ltwbesbpnr .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#ltwbesbpnr .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#ltwbesbpnr .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#ltwbesbpnr .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#ltwbesbpnr .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#ltwbesbpnr .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#ltwbesbpnr div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <caption>Dataset: whiteside,  Formula: Gas ~ Temp</caption>\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"r.squared\">r.squared</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"adj.r.squared\">adj.r.squared</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"sigma\">sigma</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"statistic\">statistic</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"p.value\">p.value</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"df\">df</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"logLik\">logLik</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"AIC\">AIC</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"BIC\">BIC</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"deviance\">deviance</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"df.residual\">df.residual</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"nobs\">nobs</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"r.squared\" class=\"gt_row gt_right\">0.47</td>\n<td headers=\"adj.r.squared\" class=\"gt_row gt_right\">0.46</td>\n<td headers=\"sigma\" class=\"gt_row gt_right\">0.86</td>\n<td headers=\"statistic\" class=\"gt_row gt_right\">47.28</td>\n<td headers=\"p.value\" class=\"gt_row gt_right\">6.55e-09</td>\n<td headers=\"df\" class=\"gt_row gt_right\">1</td>\n<td headers=\"logLik\" class=\"gt_row gt_right\">-70.04</td>\n<td headers=\"AIC\" class=\"gt_row gt_right\">146.07</td>\n<td headers=\"BIC\" class=\"gt_row gt_right\">152.15</td>\n<td headers=\"deviance\" class=\"gt_row gt_right\">39.99</td>\n<td headers=\"df.residual\" class=\"gt_row gt_right\">54</td>\n<td headers=\"nobs\" class=\"gt_row gt_right\">56</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n\n- `r.squared` (and `adj.r.squared`)\n- `sigma` estimates the noise standard deviation (under homoschedastic Gaussian noise assumption)\n- statistic is the Fisher statistic used to assess the hypothesis that the slope (`Temp` coefficient) is zero. It is compared with quantiles of Fisher distribution with 1 and 54 degrees of freedom (check `pf(47.28, df1=1, df2=54, lower.tail=F)` or `qf(6.55e-09, df1=1, df2=54, lower.tail=F)`).\n\n:::\n\n:::\n\n::: {.callout-note  title=\"Question\"}\n\n`R` offers a function `confint()` that can be fed with objects of class `lm`. Explain the output of this function.\n\n:::\n\n::: {.content-visible when-profile=\"solution\"}\n\n::: {.callout-note title=\"Solution\"}\n\nUnder the Gaussian homoschedastic noise assumption, `confint()` produces confidence intervals for estimated coefficients. Using the union bound, we can derive a conservative confidence rectangle.  \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nM <- confint(lm0, level=.95)  \n\nas_tibble(M) |>\n  mutate(Coeff=rownames(M)) |>\n  relocate(Coeff) |>\n  gt::gt() |>\n  gt::fmt_number(decimals=2)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"neilbjeizo\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#neilbjeizo table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#neilbjeizo thead, #neilbjeizo tbody, #neilbjeizo tfoot, #neilbjeizo tr, #neilbjeizo td, #neilbjeizo th {\n  border-style: none;\n}\n\n#neilbjeizo p {\n  margin: 0;\n  padding: 0;\n}\n\n#neilbjeizo .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#neilbjeizo .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#neilbjeizo .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#neilbjeizo .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#neilbjeizo .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#neilbjeizo .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#neilbjeizo .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#neilbjeizo .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#neilbjeizo .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#neilbjeizo .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#neilbjeizo .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#neilbjeizo .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#neilbjeizo .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#neilbjeizo .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#neilbjeizo .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#neilbjeizo .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#neilbjeizo .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#neilbjeizo .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#neilbjeizo .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#neilbjeizo .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#neilbjeizo .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#neilbjeizo .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#neilbjeizo .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#neilbjeizo .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#neilbjeizo .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#neilbjeizo .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#neilbjeizo .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#neilbjeizo .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#neilbjeizo .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#neilbjeizo .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#neilbjeizo .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#neilbjeizo .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#neilbjeizo .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#neilbjeizo .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#neilbjeizo .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#neilbjeizo .gt_left {\n  text-align: left;\n}\n\n#neilbjeizo .gt_center {\n  text-align: center;\n}\n\n#neilbjeizo .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#neilbjeizo .gt_font_normal {\n  font-weight: normal;\n}\n\n#neilbjeizo .gt_font_bold {\n  font-weight: bold;\n}\n\n#neilbjeizo .gt_font_italic {\n  font-style: italic;\n}\n\n#neilbjeizo .gt_super {\n  font-size: 65%;\n}\n\n#neilbjeizo .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#neilbjeizo .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#neilbjeizo .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#neilbjeizo .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#neilbjeizo .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#neilbjeizo .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#neilbjeizo .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#neilbjeizo .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#neilbjeizo div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Coeff\">Coeff</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"2.5 %\">2.5 %</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"97.5 %\">97.5 %</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"Coeff\" class=\"gt_row gt_left\">(Intercept)</td>\n<td headers=\"2.5 %\" class=\"gt_row gt_right\">5.01</td>\n<td headers=\"97.5 %\" class=\"gt_row gt_right\">5.96</td></tr>\n    <tr><td headers=\"Coeff\" class=\"gt_row gt_left\">Temp</td>\n<td headers=\"2.5 %\" class=\"gt_row gt_right\">−0.37</td>\n<td headers=\"97.5 %\" class=\"gt_row gt_right\">−0.21</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n\n:::\n\n:::\n\n::: {.callout-note title=\"Question\"}\n\nPlot a $95\\%$ confidence region for the parameters  (assuming homoschedastic Gaussian noise). \n\n\n:::\n\n\n::: {.content-visible when-profile='solution'} \n \n::: {.callout-tip title=\"Solution\"}\n\n\n\n\n::: {.cell}\n\n:::\n\n\n\n\n::: \n\n:::\n\n# Diagnostic plots\n\nMethod `plot.lm()` of generic S3 function `plot`  from base `R` offers six diagnostic plots. By default it displays four of them. \n\n::: {.callout-note title=\"Question\"}\n\nWhat are the diagnostic plots good for? \n\n:::\n\n\n::: {.content-visible when-profile=\"solution\"}\n\n::: {.callout-tip title=\"Solution\"}\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(lm0)  \n```\n\n::: {.cell-output-display}\n![](lab-linear-regression-whiteside_files/figure-html/unnamed-chunk-26-1.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](lab-linear-regression-whiteside_files/figure-html/unnamed-chunk-26-2.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](lab-linear-regression-whiteside_files/figure-html/unnamed-chunk-26-3.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](lab-linear-regression-whiteside_files/figure-html/unnamed-chunk-26-4.png){width=672}\n:::\n:::\n\n\n\n\nThe motivation and usage of diagnostic plots is explained in detail in the book by Fox and Weisberg: *An R companion to applied regression*.\n\n\n:::\n\n:::\n\nThe diagnostic plots can be built from the information gathered in the `lm` object returned by `lm(...)`. \n\n{{< fa broom >}} It is convenient to extract the required pieces of information using method `augment.lm`. of *generic function* `augment()` from package `broom`. \n\n\n::: {.content-visible when-profile=\"solution\"}\n\n::: {.callout-tip title=\"Solution\"}\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwhiteside_aug <- lm0 %>% \n  augment(whiteside)\n\nlm0 %$% ( # exposing pipe !!! \n  augment(., data=whiteside) %>% \n  mutate(across(!where(is.factor), ~ signif(.x, 3))) %>% \n  group_by(Insul) %>% \n  sample_n(5) %>% \n  ungroup() %>% \n  gt::gt() %>% \n  gt::tab_caption(glue(\"Dataset {call$data},  {deparse(call$formula)}\"))\n)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"nujyvgazaa\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#nujyvgazaa table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#nujyvgazaa thead, #nujyvgazaa tbody, #nujyvgazaa tfoot, #nujyvgazaa tr, #nujyvgazaa td, #nujyvgazaa th {\n  border-style: none;\n}\n\n#nujyvgazaa p {\n  margin: 0;\n  padding: 0;\n}\n\n#nujyvgazaa .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#nujyvgazaa .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#nujyvgazaa .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#nujyvgazaa .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#nujyvgazaa .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#nujyvgazaa .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#nujyvgazaa .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#nujyvgazaa .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#nujyvgazaa .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#nujyvgazaa .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#nujyvgazaa .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#nujyvgazaa .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#nujyvgazaa .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#nujyvgazaa .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#nujyvgazaa .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#nujyvgazaa .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#nujyvgazaa .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#nujyvgazaa .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#nujyvgazaa .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#nujyvgazaa .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#nujyvgazaa .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#nujyvgazaa .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#nujyvgazaa .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#nujyvgazaa .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#nujyvgazaa .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#nujyvgazaa .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#nujyvgazaa .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#nujyvgazaa .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#nujyvgazaa .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#nujyvgazaa .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#nujyvgazaa .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#nujyvgazaa .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#nujyvgazaa .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#nujyvgazaa .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#nujyvgazaa .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#nujyvgazaa .gt_left {\n  text-align: left;\n}\n\n#nujyvgazaa .gt_center {\n  text-align: center;\n}\n\n#nujyvgazaa .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#nujyvgazaa .gt_font_normal {\n  font-weight: normal;\n}\n\n#nujyvgazaa .gt_font_bold {\n  font-weight: bold;\n}\n\n#nujyvgazaa .gt_font_italic {\n  font-style: italic;\n}\n\n#nujyvgazaa .gt_super {\n  font-size: 65%;\n}\n\n#nujyvgazaa .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#nujyvgazaa .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#nujyvgazaa .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#nujyvgazaa .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#nujyvgazaa .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#nujyvgazaa .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#nujyvgazaa .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#nujyvgazaa .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#nujyvgazaa div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <caption>Dataset whiteside,  Gas ~ Temp</caption>\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Insul\">Insul</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Temp\">Temp</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Gas\">Gas</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\".fitted\">.fitted</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\".resid\">.resid</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\".hat\">.hat</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\".sigma\">.sigma</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\".cooksd\">.cooksd</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\".std.resid\">.std.resid</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"Insul\" class=\"gt_row gt_center\">Before</td>\n<td headers=\"Temp\" class=\"gt_row gt_right\">4.2</td>\n<td headers=\"Gas\" class=\"gt_row gt_right\">5.8</td>\n<td headers=\".fitted\" class=\"gt_row gt_right\">4.27</td>\n<td headers=\".resid\" class=\"gt_row gt_right\">1.5300</td>\n<td headers=\".hat\" class=\"gt_row gt_right\">0.0190</td>\n<td headers=\".sigma\" class=\"gt_row gt_right\">0.842</td>\n<td headers=\".cooksd\" class=\"gt_row gt_right\">0.03120</td>\n<td headers=\".std.resid\" class=\"gt_row gt_right\">1.8000</td></tr>\n    <tr><td headers=\"Insul\" class=\"gt_row gt_center\">Before</td>\n<td headers=\"Temp\" class=\"gt_row gt_right\">2.5</td>\n<td headers=\"Gas\" class=\"gt_row gt_right\">6.0</td>\n<td headers=\".fitted\" class=\"gt_row gt_right\">4.76</td>\n<td headers=\".resid\" class=\"gt_row gt_right\">1.2400</td>\n<td headers=\".hat\" class=\"gt_row gt_right\">0.0314</td>\n<td headers=\".sigma\" class=\"gt_row gt_right\">0.851</td>\n<td headers=\".cooksd\" class=\"gt_row gt_right\">0.03470</td>\n<td headers=\".std.resid\" class=\"gt_row gt_right\">1.4600</td></tr>\n    <tr><td headers=\"Insul\" class=\"gt_row gt_center\">Before</td>\n<td headers=\"Temp\" class=\"gt_row gt_right\">10.2</td>\n<td headers=\"Gas\" class=\"gt_row gt_right\">2.6</td>\n<td headers=\".fitted\" class=\"gt_row gt_right\">2.53</td>\n<td headers=\".resid\" class=\"gt_row gt_right\">0.0739</td>\n<td headers=\".hat\" class=\"gt_row gt_right\">0.0861</td>\n<td headers=\".sigma\" class=\"gt_row gt_right\">0.869</td>\n<td headers=\".cooksd\" class=\"gt_row gt_right\">0.00038</td>\n<td headers=\".std.resid\" class=\"gt_row gt_right\">0.0899</td></tr>\n    <tr><td headers=\"Insul\" class=\"gt_row gt_center\">Before</td>\n<td headers=\"Temp\" class=\"gt_row gt_right\">7.5</td>\n<td headers=\"Gas\" class=\"gt_row gt_right\">4.0</td>\n<td headers=\".fitted\" class=\"gt_row gt_right\">3.31</td>\n<td headers=\".resid\" class=\"gt_row gt_right\">0.6900</td>\n<td headers=\".hat\" class=\"gt_row gt_right\">0.0344</td>\n<td headers=\".sigma\" class=\"gt_row gt_right\">0.863</td>\n<td headers=\".cooksd\" class=\"gt_row gt_right\">0.01190</td>\n<td headers=\".std.resid\" class=\"gt_row gt_right\">0.8160</td></tr>\n    <tr><td headers=\"Insul\" class=\"gt_row gt_center\">Before</td>\n<td headers=\"Temp\" class=\"gt_row gt_right\">7.6</td>\n<td headers=\"Gas\" class=\"gt_row gt_right\">3.5</td>\n<td headers=\".fitted\" class=\"gt_row gt_right\">3.28</td>\n<td headers=\".resid\" class=\"gt_row gt_right\">0.2190</td>\n<td headers=\".hat\" class=\"gt_row gt_right\">0.0357</td>\n<td headers=\".sigma\" class=\"gt_row gt_right\">0.868</td>\n<td headers=\".cooksd\" class=\"gt_row gt_right\">0.00125</td>\n<td headers=\".std.resid\" class=\"gt_row gt_right\">0.2600</td></tr>\n    <tr><td headers=\"Insul\" class=\"gt_row gt_center\">After</td>\n<td headers=\"Temp\" class=\"gt_row gt_right\">2.5</td>\n<td headers=\"Gas\" class=\"gt_row gt_right\">3.5</td>\n<td headers=\".fitted\" class=\"gt_row gt_right\">4.76</td>\n<td headers=\".resid\" class=\"gt_row gt_right\">-1.2600</td>\n<td headers=\".hat\" class=\"gt_row gt_right\">0.0314</td>\n<td headers=\".sigma\" class=\"gt_row gt_right\">0.851</td>\n<td headers=\".cooksd\" class=\"gt_row gt_right\">0.03590</td>\n<td headers=\".std.resid\" class=\"gt_row gt_right\">-1.4900</td></tr>\n    <tr><td headers=\"Insul\" class=\"gt_row gt_center\">After</td>\n<td headers=\"Temp\" class=\"gt_row gt_right\">7.5</td>\n<td headers=\"Gas\" class=\"gt_row gt_right\">2.6</td>\n<td headers=\".fitted\" class=\"gt_row gt_right\">3.31</td>\n<td headers=\".resid\" class=\"gt_row gt_right\">-0.7100</td>\n<td headers=\".hat\" class=\"gt_row gt_right\">0.0344</td>\n<td headers=\".sigma\" class=\"gt_row gt_right\">0.863</td>\n<td headers=\".cooksd\" class=\"gt_row gt_right\">0.01260</td>\n<td headers=\".std.resid\" class=\"gt_row gt_right\">-0.8390</td></tr>\n    <tr><td headers=\"Insul\" class=\"gt_row gt_center\">After</td>\n<td headers=\"Temp\" class=\"gt_row gt_right\">4.9</td>\n<td headers=\"Gas\" class=\"gt_row gt_right\">3.7</td>\n<td headers=\".fitted\" class=\"gt_row gt_right\">4.06</td>\n<td headers=\".resid\" class=\"gt_row gt_right\">-0.3640</td>\n<td headers=\".hat\" class=\"gt_row gt_right\">0.0179</td>\n<td headers=\".sigma\" class=\"gt_row gt_right\">0.867</td>\n<td headers=\".cooksd\" class=\"gt_row gt_right\">0.00166</td>\n<td headers=\".std.resid\" class=\"gt_row gt_right\">-0.4270</td></tr>\n    <tr><td headers=\"Insul\" class=\"gt_row gt_center\">After</td>\n<td headers=\"Temp\" class=\"gt_row gt_right\">-0.7</td>\n<td headers=\"Gas\" class=\"gt_row gt_right\">4.8</td>\n<td headers=\".fitted\" class=\"gt_row gt_right\">5.69</td>\n<td headers=\".resid\" class=\"gt_row gt_right\">-0.8890</td>\n<td headers=\".hat\" class=\"gt_row gt_right\">0.0926</td>\n<td headers=\".sigma\" class=\"gt_row gt_right\">0.859</td>\n<td headers=\".cooksd\" class=\"gt_row gt_right\">0.06010</td>\n<td headers=\".std.resid\" class=\"gt_row gt_right\">-1.0800</td></tr>\n    <tr><td headers=\"Insul\" class=\"gt_row gt_center\">After</td>\n<td headers=\"Temp\" class=\"gt_row gt_right\">4.0</td>\n<td headers=\"Gas\" class=\"gt_row gt_right\">3.7</td>\n<td headers=\".fitted\" class=\"gt_row gt_right\">4.33</td>\n<td headers=\".resid\" class=\"gt_row gt_right\">-0.6250</td>\n<td headers=\".hat\" class=\"gt_row gt_right\">0.0197</td>\n<td headers=\".sigma\" class=\"gt_row gt_right\">0.864</td>\n<td headers=\".cooksd\" class=\"gt_row gt_right\">0.00541</td>\n<td headers=\".std.resid\" class=\"gt_row gt_right\">-0.7340</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n\n:::\n\n:::\n\nRecall that in the output of `augment()`\n\n- `.fitted`: $\\widehat{Y} = H \\times Y= X \\times \\widehat{\\beta}$ \n- `.resid`: $\\widehat{\\epsilon} = Y - \\widehat{Y}$ residuals, $\\sim (\\text{Id}_n - H) \\times \\epsilon$ \n- `.hat`: diagonal coefficients of Hat matrix $H$ \n- `.sigma`: is meant to be the estimated standard deviation of components of  $\\widehat{Y}$\n\nCompute the share of *explained variance* \n\n::: {.content-visible when-profile=\"solution\"}\n\n::: {.callout-tip title=\"Solution\"}\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwhiteside_aug %$% {\n  1 - (var(.resid)/(var(Gas)))\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.4668366\n```\n\n\n:::\n\n```{.r .cell-code}\n# with(whiteside_aug,\n#   1 - (var(.resid)/(var(Gas)))\n```\n:::\n\n\n\n\n:::\n\n:::\n\nPlot residuals against fitted values \n\n::: {.content-visible when-profile=\"solution\"}\n\n::: {.callout-tip title=\"Solution\"}\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndiag_1 <- whiteside_aug %>% \n  ggplot() +\n  aes(x=.fitted, y=.resid)+\n  geom_point(aes(shape= Insul), size=1, color=\"black\") +\n  geom_smooth(formula = y ~ x,\n              method=\"loess\",\n              se=F,\n              linetype=\"dotted\",\n              linewidth=.5,\n              color=\"black\") +\n  geom_hline(yintercept = 0, linetype=\"dashed\") +\n  xlab(\"Fitted values\") +\n  ylab(\"Residuals)\") +\n  labs(caption = \"Residuals versus Fitted\")\n```\n:::\n\n\n\n\n:::\n\n:::\n\n\nFitted against square root of standardized residuals.\n\n::: {.content-visible when-profile=\"solution\"}\n\n::: {.callout-tip title=\"Solution\"}\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndiag_3 <- whiteside_aug %>%\n  ggplot() +\n  aes(x=.fitted, y=sqrt(abs(.std.resid))) +\n  geom_smooth(formula = y ~ x,\n              se=F,\n              method=\"loess\",\n              linetype=\"dotted\",\n              linewidth=.5,\n              color=\"black\") +\n  xlab(\"Fitted values\") +\n  ylab(\"sqrt(|standardized residuals|)\") +\n  geom_point(aes(shape=Insul), size=1, alpha=1) +\n  labs(caption = \"Scale location\")\n```\n:::\n\n\n\n\n:::\n\n:::\n\n::: {.content-visible when-profile=\"solution\"}\n\n::: {.callout-tip title=\"Solution\"}\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndiag_2 <- whiteside_aug %>% \n  ggplot() +\n  aes(sample=.std.resid) +\n  geom_qq(size=.5, alpha=.5) +\n  stat_qq_line(linetype=\"dotted\",\n              linewidth=.5,\n              color=\"black\") +\n  coord_fixed() +\n  labs(caption=\"Residuals qqplot\") +\n  xlab(\"Theoretical quantiles\") +\n  ylab(\"Empirical quantiles of standadrdized residuals\")\n```\n:::\n\n\n\n\n:::\n\n:::\n\nTAF\n\n::: {.content-visible when-profile=\"solution\"}\n\n::: {.callout-tip title=\"Solution\"}\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n(diag_1 + diag_2 + diag_3 + guide_area()) + \n  plot_layout(guides=\"collect\") +\n  plot_annotation(title=glue(\"{cur_dataset} dataset\"),\n                  subtitle = glue(\"Regression diagnostic  {deparse(lm0$call$formula)}\"), caption = 'The fact that the sign of residuals depend on Insul shows that our modeling is too naive.\\n The qqplot suggests that the residuals are not collected from Gaussian homoschedastic noise.'\n                  )\n```\n\n::: {.cell-output-display}\n![](lab-linear-regression-whiteside_files/figure-html/unnamed-chunk-32-1.png){width=672}\n:::\n:::\n\n\n\n\n:::\n\n:::\n\n\n# Taking into account Insulation\n\nDesign a *formula* that allows us to take into account the possible \nimpact of Insulation. Insulation may impact the relation between weekly `Gas` consumption and average external `Temperature` in two ways. Insulation may modify the `Intercept`, it may also modify the slope, that is the sensitivity of `Gas` consumption  with respect to average external `Temperature`. \n\n::: {.callout-tip}\n\nHave a look at formula documentation (`?formula`).\n\n:::\n\n::: {.content-visible when-profile=\"solution\"}\n\n::: {.callout-tip title=\"Solution\"}\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlm1 <- lm(Gas ~ Temp * Insul, data = whiteside)\n```\n:::\n\n\n\n\n:::\n\n:::\n\nCheck the design using function `model.matrix()`. How can you relate this augmented design and the *one-hot encoding* of variable `Insul`?\n\n\n::: {.content-visible when-profile=\"solution\"}\n\n::: {.callout-tip title=\"Solution\"}\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel.matrix(lm1) |>\n  head()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  (Intercept) Temp InsulAfter Temp:InsulAfter\n1           1 -0.8          0               0\n2           1 -0.7          0               0\n3           1  0.4          0               0\n4           1  2.5          0               0\n5           1  2.9          0               0\n6           1  3.2          0               0\n```\n\n\n:::\n:::\n\n\n\n\n:::\n\n:::\n\n\n::: {.content-visible when-profile=\"solution\"}\n\n::: {.callout-tip title=\"Solution\"}\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlm1 %>% \n  tidy_lm()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"rjsqmxxbuc\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#rjsqmxxbuc table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#rjsqmxxbuc thead, #rjsqmxxbuc tbody, #rjsqmxxbuc tfoot, #rjsqmxxbuc tr, #rjsqmxxbuc td, #rjsqmxxbuc th {\n  border-style: none;\n}\n\n#rjsqmxxbuc p {\n  margin: 0;\n  padding: 0;\n}\n\n#rjsqmxxbuc .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#rjsqmxxbuc .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#rjsqmxxbuc .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#rjsqmxxbuc .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#rjsqmxxbuc .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#rjsqmxxbuc .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#rjsqmxxbuc .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#rjsqmxxbuc .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#rjsqmxxbuc .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#rjsqmxxbuc .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#rjsqmxxbuc .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#rjsqmxxbuc .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#rjsqmxxbuc .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#rjsqmxxbuc .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#rjsqmxxbuc .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#rjsqmxxbuc .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#rjsqmxxbuc .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#rjsqmxxbuc .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#rjsqmxxbuc .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#rjsqmxxbuc .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#rjsqmxxbuc .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#rjsqmxxbuc .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#rjsqmxxbuc .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#rjsqmxxbuc .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#rjsqmxxbuc .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#rjsqmxxbuc .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#rjsqmxxbuc .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#rjsqmxxbuc .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#rjsqmxxbuc .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#rjsqmxxbuc .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#rjsqmxxbuc .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#rjsqmxxbuc .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#rjsqmxxbuc .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#rjsqmxxbuc .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#rjsqmxxbuc .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#rjsqmxxbuc .gt_left {\n  text-align: left;\n}\n\n#rjsqmxxbuc .gt_center {\n  text-align: center;\n}\n\n#rjsqmxxbuc .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#rjsqmxxbuc .gt_font_normal {\n  font-weight: normal;\n}\n\n#rjsqmxxbuc .gt_font_bold {\n  font-weight: bold;\n}\n\n#rjsqmxxbuc .gt_font_italic {\n  font-style: italic;\n}\n\n#rjsqmxxbuc .gt_super {\n  font-size: 65%;\n}\n\n#rjsqmxxbuc .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#rjsqmxxbuc .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#rjsqmxxbuc .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#rjsqmxxbuc .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#rjsqmxxbuc .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#rjsqmxxbuc .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#rjsqmxxbuc .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#rjsqmxxbuc .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#rjsqmxxbuc div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <caption>Linear regrression. Dataset: whiteside,  Formula: Gas ~ Temp * Insul</caption>\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"term\">term</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"estimate\">estimate</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"std.error\">std.error</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"statistic\">statistic</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"p.value\">p.value</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"term\" class=\"gt_row gt_left\">(Intercept)</td>\n<td headers=\"estimate\" class=\"gt_row gt_right\">6.85</td>\n<td headers=\"std.error\" class=\"gt_row gt_right\">0.14</td>\n<td headers=\"statistic\" class=\"gt_row gt_right\">50.41</td>\n<td headers=\"p.value\" class=\"gt_row gt_right\">0.00</td></tr>\n    <tr><td headers=\"term\" class=\"gt_row gt_left\">Temp</td>\n<td headers=\"estimate\" class=\"gt_row gt_right\">−0.39</td>\n<td headers=\"std.error\" class=\"gt_row gt_right\">0.02</td>\n<td headers=\"statistic\" class=\"gt_row gt_right\">−17.49</td>\n<td headers=\"p.value\" class=\"gt_row gt_right\">0.00</td></tr>\n    <tr><td headers=\"term\" class=\"gt_row gt_left\">InsulAfter</td>\n<td headers=\"estimate\" class=\"gt_row gt_right\">−2.13</td>\n<td headers=\"std.error\" class=\"gt_row gt_right\">0.18</td>\n<td headers=\"statistic\" class=\"gt_row gt_right\">−11.83</td>\n<td headers=\"p.value\" class=\"gt_row gt_right\">0.00</td></tr>\n    <tr><td headers=\"term\" class=\"gt_row gt_left\">Temp:InsulAfter</td>\n<td headers=\"estimate\" class=\"gt_row gt_right\">0.12</td>\n<td headers=\"std.error\" class=\"gt_row gt_right\">0.03</td>\n<td headers=\"statistic\" class=\"gt_row gt_right\">3.59</td>\n<td headers=\"p.value\" class=\"gt_row gt_right\">0.00</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n\n:::\n\n:::\n\n::: {.content-visible when-profile=\"solution\"}\n\n::: {.callout-tip title=\"Solution\"}\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlm0 |>\n  glance_lm()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"wbeocegqhf\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#wbeocegqhf table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#wbeocegqhf thead, #wbeocegqhf tbody, #wbeocegqhf tfoot, #wbeocegqhf tr, #wbeocegqhf td, #wbeocegqhf th {\n  border-style: none;\n}\n\n#wbeocegqhf p {\n  margin: 0;\n  padding: 0;\n}\n\n#wbeocegqhf .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#wbeocegqhf .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#wbeocegqhf .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#wbeocegqhf .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#wbeocegqhf .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#wbeocegqhf .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#wbeocegqhf .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#wbeocegqhf .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#wbeocegqhf .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#wbeocegqhf .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#wbeocegqhf .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#wbeocegqhf .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#wbeocegqhf .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#wbeocegqhf .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#wbeocegqhf .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#wbeocegqhf .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#wbeocegqhf .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#wbeocegqhf .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#wbeocegqhf .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#wbeocegqhf .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#wbeocegqhf .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#wbeocegqhf .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#wbeocegqhf .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#wbeocegqhf .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#wbeocegqhf .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#wbeocegqhf .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#wbeocegqhf .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#wbeocegqhf .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#wbeocegqhf .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#wbeocegqhf .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#wbeocegqhf .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#wbeocegqhf .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#wbeocegqhf .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#wbeocegqhf .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#wbeocegqhf .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#wbeocegqhf .gt_left {\n  text-align: left;\n}\n\n#wbeocegqhf .gt_center {\n  text-align: center;\n}\n\n#wbeocegqhf .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#wbeocegqhf .gt_font_normal {\n  font-weight: normal;\n}\n\n#wbeocegqhf .gt_font_bold {\n  font-weight: bold;\n}\n\n#wbeocegqhf .gt_font_italic {\n  font-style: italic;\n}\n\n#wbeocegqhf .gt_super {\n  font-size: 65%;\n}\n\n#wbeocegqhf .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#wbeocegqhf .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#wbeocegqhf .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#wbeocegqhf .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#wbeocegqhf .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#wbeocegqhf .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#wbeocegqhf .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#wbeocegqhf .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#wbeocegqhf div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <caption>Dataset: whiteside,  Formula: Gas ~ Temp</caption>\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"r.squared\">r.squared</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"adj.r.squared\">adj.r.squared</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"sigma\">sigma</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"statistic\">statistic</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"p.value\">p.value</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"df\">df</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"logLik\">logLik</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"AIC\">AIC</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"BIC\">BIC</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"deviance\">deviance</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"df.residual\">df.residual</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"nobs\">nobs</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"r.squared\" class=\"gt_row gt_right\">0.47</td>\n<td headers=\"adj.r.squared\" class=\"gt_row gt_right\">0.46</td>\n<td headers=\"sigma\" class=\"gt_row gt_right\">0.86</td>\n<td headers=\"statistic\" class=\"gt_row gt_right\">47.28</td>\n<td headers=\"p.value\" class=\"gt_row gt_right\">6.55e-09</td>\n<td headers=\"df\" class=\"gt_row gt_right\">1</td>\n<td headers=\"logLik\" class=\"gt_row gt_right\">-70.04</td>\n<td headers=\"AIC\" class=\"gt_row gt_right\">146.07</td>\n<td headers=\"BIC\" class=\"gt_row gt_right\">152.15</td>\n<td headers=\"deviance\" class=\"gt_row gt_right\">39.99</td>\n<td headers=\"df.residual\" class=\"gt_row gt_right\">54</td>\n<td headers=\"nobs\" class=\"gt_row gt_right\">56</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n\n```{.r .cell-code}\nlm1 %>% \n  glance_lm()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"ojxcpnqsyo\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#ojxcpnqsyo table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#ojxcpnqsyo thead, #ojxcpnqsyo tbody, #ojxcpnqsyo tfoot, #ojxcpnqsyo tr, #ojxcpnqsyo td, #ojxcpnqsyo th {\n  border-style: none;\n}\n\n#ojxcpnqsyo p {\n  margin: 0;\n  padding: 0;\n}\n\n#ojxcpnqsyo .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#ojxcpnqsyo .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#ojxcpnqsyo .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#ojxcpnqsyo .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#ojxcpnqsyo .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ojxcpnqsyo .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ojxcpnqsyo .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ojxcpnqsyo .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#ojxcpnqsyo .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#ojxcpnqsyo .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#ojxcpnqsyo .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#ojxcpnqsyo .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#ojxcpnqsyo .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#ojxcpnqsyo .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#ojxcpnqsyo .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#ojxcpnqsyo .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#ojxcpnqsyo .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#ojxcpnqsyo .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#ojxcpnqsyo .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ojxcpnqsyo .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#ojxcpnqsyo .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#ojxcpnqsyo .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#ojxcpnqsyo .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ojxcpnqsyo .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#ojxcpnqsyo .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#ojxcpnqsyo .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ojxcpnqsyo .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ojxcpnqsyo .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#ojxcpnqsyo .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ojxcpnqsyo .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#ojxcpnqsyo .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ojxcpnqsyo .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ojxcpnqsyo .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ojxcpnqsyo .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ojxcpnqsyo .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ojxcpnqsyo .gt_left {\n  text-align: left;\n}\n\n#ojxcpnqsyo .gt_center {\n  text-align: center;\n}\n\n#ojxcpnqsyo .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#ojxcpnqsyo .gt_font_normal {\n  font-weight: normal;\n}\n\n#ojxcpnqsyo .gt_font_bold {\n  font-weight: bold;\n}\n\n#ojxcpnqsyo .gt_font_italic {\n  font-style: italic;\n}\n\n#ojxcpnqsyo .gt_super {\n  font-size: 65%;\n}\n\n#ojxcpnqsyo .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#ojxcpnqsyo .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#ojxcpnqsyo .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#ojxcpnqsyo .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#ojxcpnqsyo .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#ojxcpnqsyo .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#ojxcpnqsyo .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#ojxcpnqsyo .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#ojxcpnqsyo div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <caption>Dataset: whiteside,  Formula: Gas ~ Temp * Insul</caption>\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"r.squared\">r.squared</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"adj.r.squared\">adj.r.squared</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"sigma\">sigma</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"statistic\">statistic</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"p.value\">p.value</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"df\">df</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"logLik\">logLik</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"AIC\">AIC</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"BIC\">BIC</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"deviance\">deviance</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"df.residual\">df.residual</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"nobs\">nobs</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"r.squared\" class=\"gt_row gt_right\">0.93</td>\n<td headers=\"adj.r.squared\" class=\"gt_row gt_right\">0.92</td>\n<td headers=\"sigma\" class=\"gt_row gt_right\">0.32</td>\n<td headers=\"statistic\" class=\"gt_row gt_right\">222.33</td>\n<td headers=\"p.value\" class=\"gt_row gt_right\">1.23e-29</td>\n<td headers=\"df\" class=\"gt_row gt_right\">3</td>\n<td headers=\"logLik\" class=\"gt_row gt_right\">-14.1</td>\n<td headers=\"AIC\" class=\"gt_row gt_right\">38.2</td>\n<td headers=\"BIC\" class=\"gt_row gt_right\">48.33</td>\n<td headers=\"deviance\" class=\"gt_row gt_right\">5.43</td>\n<td headers=\"df.residual\" class=\"gt_row gt_right\">52</td>\n<td headers=\"nobs\" class=\"gt_row gt_right\">56</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n\n:::\n\n:::\n\n::: {.content-visible when-profile=\"solution\"}\n\n::: {.callout-tip title=\"Solution\"}\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\np +\n  geom_smooth(formula='y ~ poly(x, 2)',linewidth=.5, color=\"black\",linetype=\"dashed\",  method=\"lm\", se=FALSE)+\n  aes(color=Insul) +\n  geom_smooth(aes(linetype=Insul), \n              formula='y ~ x',linewidth=.5, color=\"black\", method=\"lm\", se=FALSE) +\n  scale_color_manual(values= c(\"Before\"=\"red\", \"After\"=\"blue\")) +\n  geom_abline(intercept = 6.8538, slope=-.3932, color=\"red\") +\n  geom_abline(intercept = 6.8538 - 2.13, slope=-.3932 +.1153, color=\"blue\") + labs(\n    title=glue(\"{cur_dataset} dataset\"),\n    subtitle = glue(\"Regression: {deparse(lm1$call$formula)}\")\n    )\n```\n\n::: {.cell-output-display}\n![](lab-linear-regression-whiteside_files/figure-html/unnamed-chunk-37-1.png){width=672}\n:::\n:::\n\n\n\n\n:::\n\n:::\n\n::: {.content-visible when-profile=\"solution\"}\n\n::: {.callout-tip title=\"Solution\"}\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwhiteside_aug1 <-  augment(lm1, whiteside)\n\n(diag_1 %+% whiteside_aug1) +\n(diag_2 %+% whiteside_aug1) +\n(diag_3 %+% whiteside_aug1) +  \n guide_area() +\n  plot_layout(guides = \"collect\") +\n  plot_annotation(title=glue(\"{cur_dataset} dataset\"),\n                  subtitle = glue(\"Regression diagnostic  {deparse(lm1$call$formula)}\"), caption = 'One possible outlier.\\n Visible on all three plots.'\n                  )\n```\n\n::: {.cell-output-display}\n![](lab-linear-regression-whiteside_files/figure-html/lm1-diagnostics-1.png){width=672}\n:::\n:::\n\n\n\n\nThe formula argument defines the design matrix and the Least-Squares problem used to estimate the coefficients.\n\n:::\n\n:::\n\n\nFunction `model.matrix()` allows us to inspect the design matrix. \n\n\n::: {.content-visible when-profile=\"solution\"}\n\n::: {.callout-tip title=\"Solution\"}\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel.matrix(lm1) %>% \n  as_tibble() %>% \n  mutate(Insul=ifelse(InsulAfter,\"After\", \"Before\")) %>% \n  ungroup() %>% \n  DT::datatable(caption=glue(\"Design matrix for {deparse(lm1$call$formula)}\"))\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"datatables html-widget html-fill-item\" id=\"htmlwidget-7e3479459dc8247840df\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-7e3479459dc8247840df\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"caption\":\"<caption>Design matrix for Gas ~ Temp * Insul<\\/caption>\",\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15\",\"16\",\"17\",\"18\",\"19\",\"20\",\"21\",\"22\",\"23\",\"24\",\"25\",\"26\",\"27\",\"28\",\"29\",\"30\",\"31\",\"32\",\"33\",\"34\",\"35\",\"36\",\"37\",\"38\",\"39\",\"40\",\"41\",\"42\",\"43\",\"44\",\"45\",\"46\",\"47\",\"48\",\"49\",\"50\",\"51\",\"52\",\"53\",\"54\",\"55\",\"56\"],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[-0.8,-0.7,0.4,2.5,2.9,3.2,3.6,3.9,4.2,4.3,5.4,6,6,6,6.2,6.3,6.9,7,7.4,7.5,7.5,7.6,8,8.5,9.1,10.2,-0.7,0.8,1,1.4,1.5,1.6,2.3,2.5,2.5,3.1,3.9,4,4,4.2,4.3,4.6,4.7,4.9,4.9,4.9,5,5.3,6.2,7.1,7.2,7.5,8,8.699999999999999,8.800000000000001,9.699999999999999],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[-0,-0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-0.7,0.8,1,1.4,1.5,1.6,2.3,2.5,2.5,3.1,3.9,4,4,4.2,4.3,4.6,4.7,4.9,4.9,4.9,5,5.3,6.2,7.1,7.2,7.5,8,8.699999999999999,8.800000000000001,9.699999999999999],[\"Before\",\"Before\",\"Before\",\"Before\",\"Before\",\"Before\",\"Before\",\"Before\",\"Before\",\"Before\",\"Before\",\"Before\",\"Before\",\"Before\",\"Before\",\"Before\",\"Before\",\"Before\",\"Before\",\"Before\",\"Before\",\"Before\",\"Before\",\"Before\",\"Before\",\"Before\",\"After\",\"After\",\"After\",\"After\",\"After\",\"After\",\"After\",\"After\",\"After\",\"After\",\"After\",\"After\",\"After\",\"After\",\"After\",\"After\",\"After\",\"After\",\"After\",\"After\",\"After\",\"After\",\"After\",\"After\",\"After\",\"After\",\"After\",\"After\",\"After\",\"After\"]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>(Intercept)<\\/th>\\n      <th>Temp<\\/th>\\n      <th>InsulAfter<\\/th>\\n      <th>Temp:InsulAfter<\\/th>\\n      <th>Insul<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[1,2,3,4]},{\"orderable\":false,\"targets\":0},{\"name\":\" \",\"targets\":0},{\"name\":\"(Intercept)\",\"targets\":1},{\"name\":\"Temp\",\"targets\":2},{\"name\":\"InsulAfter\",\"targets\":3},{\"name\":\"Temp:InsulAfter\",\"targets\":4},{\"name\":\"Insul\",\"targets\":5}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nX <- model.matrix(lm1)\n```\n:::\n\n\n\n\n:::\n\n:::\n\n\nIn order to solve le Least-Square problems, we have to compute \n$$(X^T \\times X)^{-1} \\times X^T$$\nThis can be done in several ways.\n\n`lm()` uses QR factorization. \n\n\n::: {.content-visible when-profile=\"solution\"}\n\n::: {.callout-tip title=\"Solution\"}\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nQ <- qr.Q(lm1$qr)\nR <- qr.R(lm1$qr)  # R is upper triangular \n\nnorm(X - Q %*% R, type=\"F\") # QR Factorization\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 1.753321e-14\n```\n\n\n:::\n\n```{.r .cell-code}\nsignif(t(Q) %*% Q, 2)      # Q's columns form an orthonormal family\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n         [,1]     [,2]     [,3]    [,4]\n[1,]  1.0e+00 -1.4e-17  3.1e-17 1.7e-16\n[2,] -1.4e-17  1.0e+00 -3.5e-17 1.4e-17\n[3,]  3.1e-17 -3.5e-17  1.0e+00 0.0e+00\n[4,]  1.7e-16  1.4e-17  0.0e+00 1.0e+00\n```\n\n\n:::\n\n```{.r .cell-code}\nH <- Q %*% t(Q)             # The Hat matrix \n\nnorm(X - H %*% X, type=\"F\") # H leaves X's columns invariant\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 1.758479e-14\n```\n\n\n:::\n\n```{.r .cell-code}\nnorm(H - H %*% H, type=\"F\") # H is idempotent\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 7.993681e-16\n```\n\n\n:::\n\n```{.r .cell-code}\n# eigen(H, symmetric = TRUE, only.values = TRUE)$values\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsum((solve(t(X) %*% X) %*% t(X) %*% whiteside$Gas - lm1$coefficients)^2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 3.075652e-29\n```\n\n\n:::\n:::\n\n\n\n\nOnce we have the QR factorization of $X$, solving the normal equations boils down to inverting a triangular matrix. \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsum((solve(R) %*% t(Q) %*% whiteside$Gas - lm1$coefficients)^2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 2.050287e-29\n```\n\n\n:::\n:::\n\n\n\n\n:::\n\n:::\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#matador::mat2latex(signif(solve(t(X) %*% X), 2))\n```\n:::\n\n\n\n\n$$\n(X^T \\times X)^{-1} = \\begin{bmatrix}\n0.18 & -0.026 & -0.18 & 0.026\\\\\n-0.026 & 0.0048 & 0.026 & -0.0048\\\\\n-0.18 & 0.026 & 0.31 & -0.048\\\\\n0.026 & -0.0048 & -0.048 & 0.0099\n\\end{bmatrix}\n$$\n\n\n::: {.content-visible when-profile=\"solution\"}\n\n::: {.callout-tip title=\"Solution\"}\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwhiteside_aug1 %>% \n  glimpse()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 56\nColumns: 9\n$ Insul      <fct> Before, Before, Before, Before, Before, Before, Before, Bef…\n$ Temp       <dbl> -0.8, -0.7, 0.4, 2.5, 2.9, 3.2, 3.6, 3.9, 4.2, 4.3, 5.4, 6.…\n$ Gas        <dbl> 7.2, 6.9, 6.4, 6.0, 5.8, 5.8, 5.6, 4.7, 5.8, 5.2, 4.9, 4.9,…\n$ .fitted    <dbl> 7.168419, 7.129095, 6.696532, 5.870731, 5.713435, 5.595463,…\n$ .resid     <dbl> 0.031581243, -0.229094875, -0.296532170, 0.129269357, 0.086…\n$ .hat       <dbl> 0.22177670, 0.21586370, 0.15721835, 0.07782904, 0.06755399,…\n$ .sigma     <dbl> 0.3261170, 0.3241373, 0.3230041, 0.3256103, 0.3259138, 0.32…\n$ .cooksd    <dbl> 0.0008751645, 0.0441520664, 0.0466380672, 0.0036646607, 0.0…\n$ .std.resid <dbl> 0.11083298, -0.80096122, -1.00001423, 0.41675591, 0.2775375…\n```\n\n\n:::\n:::\n\n\n\n\n:::\n\n:::\n\n\nUnderstanding `.fitted` column\n\n\n::: {.content-visible when-profile=\"solution\"}\n\n::: {.callout-tip title=\"Solution\"}\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsum((predict(lm1, newdata = whiteside) - whiteside_aug1$.fitted)^2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0\n```\n\n\n:::\n\n```{.r .cell-code}\nsum((H %*% whiteside_aug1$Gas - whiteside_aug1$.fitted)^2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 3.478877e-28\n```\n\n\n:::\n:::\n\n\n\n\n:::\n\n:::\n\n\nUnderstanding `.resid`\n\n::: {.content-visible when-profile=\"solution\"}\n\n::: {.callout-tip title=\"Solution\"}\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsum((whiteside_aug1$.resid + H %*% whiteside_aug1$Gas - whiteside_aug1$Gas)^2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 3.461127e-28\n```\n\n\n:::\n:::\n\n\n\n\n:::\n\n:::\n\n\nUnderstanding `.hat`\n\n::: {.content-visible when-profile=\"solution\"}\n\n::: {.callout-tip title=\"Solution\"}\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsum((whiteside_aug1$.hat - diag(H))^2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0\n```\n\n\n:::\n:::\n\n\n\n\n:::\n\n:::\n\n\n\nUnderstanding `.std.resid` \n\n::: {.content-visible when-profile=\"solution\"}\n\n::: {.callout-tip title=\"Solution\"}\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsigma_hat <- sqrt(sum(lm1$residuals^2)/lm1$df.residual)\n\nlm1 %>% glance() \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 12\n  r.squared adj.r.squared sigma statistic  p.value    df logLik   AIC   BIC\n      <dbl>         <dbl> <dbl>     <dbl>    <dbl> <dbl>  <dbl> <dbl> <dbl>\n1     0.928         0.924 0.323      222. 1.23e-29     3  -14.1  38.2  48.3\n# ℹ 3 more variables: deviance <dbl>, df.residual <int>, nobs <int>\n```\n\n\n:::\n:::\n\n\n\n\n$$\n\\widehat{r}_i = \\frac{\\widehat{\\epsilon}_i}{\\widehat{\\sigma} \\sqrt{1 - H_{i,i}}}\n$$\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsum((sigma_hat * sqrt(1 -whiteside_aug1$.hat) * whiteside_aug1$.std.resid - whiteside_aug1$.resid)^2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 4.471837e-28\n```\n\n\n:::\n:::\n\n\n\n\n\n:::\n\n:::\n\nUnderstanding column `.sigma` \n\n::: {.content-visible when-profile=\"solution\"}\n\n::: {.callout-tip title=\"Solution\"}\n\n\nColumn `.sigma` contains the *leave-one-out* estimates of $\\sigma$, that is `whiteside_aug1$.sigma[i]` is the estimate of $\\sigma$ you obtain by leaving out the `i` row of the dataframe. \n\nThere is no need to recompute everything for each sample element.\n\n$$\n\\widehat{\\sigma}^2_{(i)} =  \\widehat{\\sigma}^2 \\frac{n-p-1- \\frac{\\widehat{\\epsilon}_i^2}{\\widehat{\\sigma}^2 {(1 - H_{i,i})}}\\frac{}{}}{n-p-2}\n$$\n\n:::\n\n:::\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/htmltools-fill-0.5.8.1/fill.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<link href=\"../../site_libs/datatables-css-0.0.0/datatables-crosstalk.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/datatables-binding-0.33/datatables.js\"></script>\n<script src=\"../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js\"></script>\n<link href=\"../../site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css\" rel=\"stylesheet\" />\n<link href=\"../../site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js\"></script>\n<link href=\"../../site_libs/crosstalk-1.2.1/css/crosstalk.min.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/crosstalk-1.2.1/js/crosstalk.min.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}
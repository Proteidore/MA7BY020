{
  "hash": "632f8d0716a509852f058d605aef23a7",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Lab: Canonical Correlation Analysis\"\ndate: \"2025-03-27 12:56:10.797381\"\n\n\nformat:\n  html:\n    output-file: lab-cca.html\n  pdf:\n    output-file: lab-cca.pdf\n \nengine: knitr\n\nexecute: \n  eval: false\n  echo: true\n---\n\n\n\n\n::: {layout=\"[80,20]\"}\n\n::: {#first-column}\n\n|                            |\n|:---------------------------|\n| {{< var curriculum >}}     |\n| {{< var university >}}     |\n| Ann√©e {{< var year >}}     |\n| {{< var homepage >}}       |\n| {{< var moodle >}}         |\n\n\n::: \n\n::: {#second-column}\n![](/images/UniversiteParis_monogramme_couleur_RVB.png){align=\"right\" style=\"size:50px;\" width=75}\n:::\n\n:::\n\n\n\n\n\n::: {.cell}\n\n:::\n\n\n\n\n## Canonical Correlation Analysis \n\n$$C(X,Y) = \\mathbb{E}\\left[X Y^\\top\\right]$$\n\n$$\\begin{bmatrix} C_{xx} & C_{xy} \\\\ C_{xy}^{\\top} & C_{yy}\\end{bmatrix}$$\n\n\n\n\n\n::: {.cell}\n\n```{.tex .cell-code}\n\\begin{bmatrix} C_{xx} & C_{xy} \\\\ C_{xy}^{\\top} & C_{yy}\\end{bmatrix}\n```\n:::\n\n\n\n\n\nThe first canonical components are the solution of the next problem \n\n::: {.callout-note title=\"Optimization problem\"}\n\n$$\\begin{array}{lll}\\text{Maximize} & & u^\\top C_{xy}  v \\\\\\text{subject to} & & u^\\top C_{xx} uv=1 =v^\\top C_{yy} v     \\end{array}$$\n\n:::\n\n\n\n\n::: {.callout-note title=\"Proposition\"}\n\nLet \n\n$$U \\times D \\times V^\\top$$\n\nbe a SVD of \n\n$$C_{xx}^{-1/2} \\times C_{xy} \\times C_{yy}^{-1/2}$$\n\nThe solution to the optimization problem above is \n\n$$a = C_{xx}^{-1/2} u_1 \\qquad \\text{and} \\qquad b= S_{yy}^{-1/2} v_1$$\n\nwhere $u_1$ and $v_1$ are the leading left and right singular vectors of  $C_{xx}^{-1/2} \\times C_{xy} \\times C_{yy}^{-1/2}$, that is the first column vectors of $U$ and $V$.\n\n:::\n\n<!-- This is also related to the extended SVD of $C_{xy}$ relatively to $C_{xx}^{-1}$ and $C_{yy}^{-1}$ -->\n\nProof:  {{< fa chalkboard-teacher >}}\n\n::: {.callout-note title=\"Proposition\"}\n\nA sequence of canonical components of $C_{xy}$ can be obtained \nfrom the sequence of (extended) left and right singular vectors of $C_{xy}$ with respect \nto $C_{xx}$ and $C_{yy}$ \n\n:::\n\nProof:  {{< fa chalkboard-teacher >}}\n\n\n## Canonical Correlation Analysis (CCA) in `R`\n\n###  `cancor()` from base package  `R`\n\n/usr/lib/R/library/stats/help/cancor\n\n\n\n\n\n```{.r .cell-code}\n?LifeCycleSavings\n```\n\n::: {.cell}\n\n```{.r .cell-code}\nLifeCycleSavings |>\n  slice_sample(n=5)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npairs(LifeCycleSavings, \n      panel = panel.smooth,\n      main = \"LifeCycleSavings data\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfm1 <- lm(sr ~ pop15 + pop75 + dpi + ddpi, data = LifeCycleSavings)\n \nsummary(fm1)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npop <- LifeCycleSavings |> \n  select(starts_with('pop'))\noec <- LifeCycleSavings |> \n  select(-starts_with('pop'))\n  \nres.cca <- cancor(pop, oec)\n```\n:::\n\n\n\n\n\n\n::: {.callout-note title='Question'} \n \nCheck that the different components of the output of `cancor()` satisfy all \nproperties they should satisfy. \n\n:::\n\n::: {.content-visible when-profile='solution'} \n \n::: {.callout-tip title='Solution'} \n \n \n:::\n\n:::\n\n::: {.callout-note title='Question'} \n \n\nDesign a suite of tests (using `testthat`) that any contender of the implementation \nprovided by package `stats` should pass.  \n \n:::\n\n\n::: {.content-visible when-profile='solution'} \n \n::: {.callout-tip title='Solution'} \n \n \n:::\n \n:::\n\n### Package `CCA` \n\n\n\n## Applications \n\n\n## References \n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}
{
  "hash": "f2e8003b831c0df52405a92a03cd93d3",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: 'LAB: Linear Regression on Whiteside data (2)'\ndate: \"2025-03-12 10:19:06.60183\"\ndraft: false \n\nexecute:\n  echo: true\n  eval: true\n  collapse: true\n\n\nformat:\n  html:\n    output-file: lab-linear-regression-whiteside-2.html\n  pdf:\n    output-file: lab-linear-regression-whiteside-2.pdf\n\n\n---\n\n\n\n\n::: {layout=\"[80,20]\"}\n\n::: {#first-column}\n\n|                            |\n|:---------------------------|\n| {{< var curriculum >}}     |\n| {{< var university >}}     |\n| Ann√©e {{< var year >}}     |\n| {{< var homepage >}}       |\n| {{< var moodle >}}         |\n\n\n::: \n\n::: {#second-column}\n![](/images/UniversiteParis_monogramme_couleur_RVB.png){align=\"right\" style=\"size:50px;\" width=75}\n:::\n\n:::\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# We will use the following packages. \n# If needed, install them : pak::pkg_install(). \nstopifnot(\n  require(\"MASS\"),\n  require(\"isotone\"),\n  require(\"magrittr\"),\n  require(\"lobstr\"),\n  require(\"ggforce\"),\n  require(\"patchwork\"), \n  require(\"gt\"),\n  require(\"glue\"),\n  require(\"skimr\"),\n  require(\"corrr\"),\n  require(\"GGally\"),\n  require(\"broom\"),\n  require(\"tidyverse\"),\n  require(\"ggfortify\"),\n  require(\"autoplotly\")\n)\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(whiteside)\n```\n:::\n\n\n\n\n## Model comparison\n\n\n::: {.callout-note title='Question'} \n\nFor the Whiteside data, build a linear model where the covariates are the interactions of `Insul`  with powers of `Temp` (up to degree 5). \n\n:::\n\n\n::: {.content-visible when-profile='solution'} \n \n::: {.callout-tip title='Solution'} \n \n\n \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlm_5 <- whiteside |>\n  mutate(feat=poly(Temp, degree=5, raw=T)) |>\n  select(-Temp) |>\n  rename_with(~ gsub('feat', 'Temp_', .), contains('feat')) %>%\n  lm(Gas ~ Insul*., data=.)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntidy_lmm <- function(lmm){\n  lmm |> \n  tidy() |>\n  gt::gt() |>\n  gt::fmt_scientific(p.value) |>\n  gt::fmt_number(-p.value, decimals=2) |>\n  gt::tab_caption(glue(\"Formula: {deparse(lmm$call$formula)}\"))\n}\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlm_5 |> \n  tidy_lmm()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"lovxxqusve\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#lovxxqusve table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#lovxxqusve thead, #lovxxqusve tbody, #lovxxqusve tfoot, #lovxxqusve tr, #lovxxqusve td, #lovxxqusve th {\n  border-style: none;\n}\n\n#lovxxqusve p {\n  margin: 0;\n  padding: 0;\n}\n\n#lovxxqusve .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#lovxxqusve .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#lovxxqusve .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#lovxxqusve .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#lovxxqusve .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#lovxxqusve .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#lovxxqusve .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#lovxxqusve .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#lovxxqusve .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#lovxxqusve .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#lovxxqusve .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#lovxxqusve .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#lovxxqusve .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#lovxxqusve .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#lovxxqusve .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#lovxxqusve .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#lovxxqusve .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#lovxxqusve .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#lovxxqusve .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#lovxxqusve .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#lovxxqusve .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#lovxxqusve .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#lovxxqusve .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#lovxxqusve .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#lovxxqusve .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#lovxxqusve .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#lovxxqusve .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#lovxxqusve .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#lovxxqusve .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#lovxxqusve .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#lovxxqusve .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#lovxxqusve .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#lovxxqusve .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#lovxxqusve .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#lovxxqusve .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#lovxxqusve .gt_left {\n  text-align: left;\n}\n\n#lovxxqusve .gt_center {\n  text-align: center;\n}\n\n#lovxxqusve .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#lovxxqusve .gt_font_normal {\n  font-weight: normal;\n}\n\n#lovxxqusve .gt_font_bold {\n  font-weight: bold;\n}\n\n#lovxxqusve .gt_font_italic {\n  font-style: italic;\n}\n\n#lovxxqusve .gt_super {\n  font-size: 65%;\n}\n\n#lovxxqusve .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#lovxxqusve .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#lovxxqusve .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#lovxxqusve .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#lovxxqusve .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#lovxxqusve .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#lovxxqusve .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#lovxxqusve .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#lovxxqusve div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <caption>Formula: Gas ~ Insul * .</caption>\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"term\">term</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"estimate\">estimate</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"std.error\">std.error</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"statistic\">statistic</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"p.value\">p.value</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"term\" class=\"gt_row gt_left\">(Intercept)</td>\n<td headers=\"estimate\" class=\"gt_row gt_right\">6.58</td>\n<td headers=\"std.error\" class=\"gt_row gt_right\">0.25</td>\n<td headers=\"statistic\" class=\"gt_row gt_right\">26.34</td>\n<td headers=\"p.value\" class=\"gt_row gt_right\">1.41&nbsp;√ó&nbsp;10<sup style='font-size: 65%;'>‚àí28</sup></td></tr>\n    <tr><td headers=\"term\" class=\"gt_row gt_left\">InsulAfter</td>\n<td headers=\"estimate\" class=\"gt_row gt_right\">‚àí1.75</td>\n<td headers=\"std.error\" class=\"gt_row gt_right\">0.32</td>\n<td headers=\"statistic\" class=\"gt_row gt_right\">‚àí5.40</td>\n<td headers=\"p.value\" class=\"gt_row gt_right\">2.57&nbsp;√ó&nbsp;10<sup style='font-size: 65%;'>‚àí6</sup></td></tr>\n    <tr><td headers=\"term\" class=\"gt_row gt_left\">Temp_1</td>\n<td headers=\"estimate\" class=\"gt_row gt_right\">‚àí0.46</td>\n<td headers=\"std.error\" class=\"gt_row gt_right\">0.21</td>\n<td headers=\"statistic\" class=\"gt_row gt_right\">‚àí2.18</td>\n<td headers=\"p.value\" class=\"gt_row gt_right\">3.46&nbsp;√ó&nbsp;10<sup style='font-size: 65%;'>‚àí2</sup></td></tr>\n    <tr><td headers=\"term\" class=\"gt_row gt_left\">Temp_2</td>\n<td headers=\"estimate\" class=\"gt_row gt_right\">0.18</td>\n<td headers=\"std.error\" class=\"gt_row gt_right\">0.21</td>\n<td headers=\"statistic\" class=\"gt_row gt_right\">0.88</td>\n<td headers=\"p.value\" class=\"gt_row gt_right\">3.83&nbsp;√ó&nbsp;10<sup style='font-size: 65%;'>‚àí1</sup></td></tr>\n    <tr><td headers=\"term\" class=\"gt_row gt_left\">Temp_3</td>\n<td headers=\"estimate\" class=\"gt_row gt_right\">‚àí0.06</td>\n<td headers=\"std.error\" class=\"gt_row gt_right\">0.06</td>\n<td headers=\"statistic\" class=\"gt_row gt_right\">‚àí0.95</td>\n<td headers=\"p.value\" class=\"gt_row gt_right\">3.46&nbsp;√ó&nbsp;10<sup style='font-size: 65%;'>‚àí1</sup></td></tr>\n    <tr><td headers=\"term\" class=\"gt_row gt_left\">Temp_4</td>\n<td headers=\"estimate\" class=\"gt_row gt_right\">0.01</td>\n<td headers=\"std.error\" class=\"gt_row gt_right\">0.01</td>\n<td headers=\"statistic\" class=\"gt_row gt_right\">0.94</td>\n<td headers=\"p.value\" class=\"gt_row gt_right\">3.50&nbsp;√ó&nbsp;10<sup style='font-size: 65%;'>‚àí1</sup></td></tr>\n    <tr><td headers=\"term\" class=\"gt_row gt_left\">Temp_5</td>\n<td headers=\"estimate\" class=\"gt_row gt_right\">0.00</td>\n<td headers=\"std.error\" class=\"gt_row gt_right\">0.00</td>\n<td headers=\"statistic\" class=\"gt_row gt_right\">‚àí0.92</td>\n<td headers=\"p.value\" class=\"gt_row gt_right\">3.62&nbsp;√ó&nbsp;10<sup style='font-size: 65%;'>‚àí1</sup></td></tr>\n    <tr><td headers=\"term\" class=\"gt_row gt_left\">InsulAfter:Temp_1</td>\n<td headers=\"estimate\" class=\"gt_row gt_right\">0.22</td>\n<td headers=\"std.error\" class=\"gt_row gt_right\">0.30</td>\n<td headers=\"statistic\" class=\"gt_row gt_right\">0.74</td>\n<td headers=\"p.value\" class=\"gt_row gt_right\">4.65&nbsp;√ó&nbsp;10<sup style='font-size: 65%;'>‚àí1</sup></td></tr>\n    <tr><td headers=\"term\" class=\"gt_row gt_left\">InsulAfter:Temp_2</td>\n<td headers=\"estimate\" class=\"gt_row gt_right\">‚àí0.42</td>\n<td headers=\"std.error\" class=\"gt_row gt_right\">0.29</td>\n<td headers=\"statistic\" class=\"gt_row gt_right\">‚àí1.44</td>\n<td headers=\"p.value\" class=\"gt_row gt_right\">1.56&nbsp;√ó&nbsp;10<sup style='font-size: 65%;'>‚àí1</sup></td></tr>\n    <tr><td headers=\"term\" class=\"gt_row gt_left\">InsulAfter:Temp_3</td>\n<td headers=\"estimate\" class=\"gt_row gt_right\">0.16</td>\n<td headers=\"std.error\" class=\"gt_row gt_right\">0.09</td>\n<td headers=\"statistic\" class=\"gt_row gt_right\">1.73</td>\n<td headers=\"p.value\" class=\"gt_row gt_right\">9.07&nbsp;√ó&nbsp;10<sup style='font-size: 65%;'>‚àí2</sup></td></tr>\n    <tr><td headers=\"term\" class=\"gt_row gt_left\">InsulAfter:Temp_4</td>\n<td headers=\"estimate\" class=\"gt_row gt_right\">‚àí0.02</td>\n<td headers=\"std.error\" class=\"gt_row gt_right\">0.01</td>\n<td headers=\"statistic\" class=\"gt_row gt_right\">‚àí1.80</td>\n<td headers=\"p.value\" class=\"gt_row gt_right\">7.87&nbsp;√ó&nbsp;10<sup style='font-size: 65%;'>‚àí2</sup></td></tr>\n    <tr><td headers=\"term\" class=\"gt_row gt_left\">InsulAfter:Temp_5</td>\n<td headers=\"estimate\" class=\"gt_row gt_right\">0.00</td>\n<td headers=\"std.error\" class=\"gt_row gt_right\">0.00</td>\n<td headers=\"statistic\" class=\"gt_row gt_right\">1.78</td>\n<td headers=\"p.value\" class=\"gt_row gt_right\">8.22&nbsp;√ó&nbsp;10<sup style='font-size: 65%;'>‚àí2</sup></td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlm_5 |>\n  glance()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 √ó 12\n  r.squared adj.r.squared sigma statistic  p.value    df logLik   AIC   BIC\n      <dbl>         <dbl> <dbl>     <dbl>    <dbl> <dbl>  <dbl> <dbl> <dbl>\n1     0.945         0.932 0.305      69.1 4.80e-24    11  -6.28  38.6  64.9\n# ‚Ñπ 3 more variables: deviance <dbl>, df.residual <int>, nobs <int>\n```\n\n\n:::\n:::\n\n\n\n\n:::\n\n:::\n\n::: {.callout-note title='Question'} \n \nCompare model `Gas ~ Insul* poly(Temp, 5, raw=T)` with models `Gas ~ Insul + Temp` and `Gas ~ Insul * Temp`.\n\n:::\n\n\n::: {.content-visible when-profile='solution'} \n \n \n::: {.callout-tip title='Solution'} \n \n \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlst_formulae <-  c('Gas ~ Insul + Temp', 'Gas ~ Insul * Temp', 'Gas ~ Insul* poly(Temp, 5, raw=T)') |>\n  map(as.formula)\n\nlst_models <- map(lst_formulae, \\(x) lm(x, data=whiteside))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlst_models |>\n  purrr::map_dfr(glance) |>\n  mutate(form=map_chr(lst_formulae,deparse)) |>\n  relocate(form) |>\n  select(1:7) |>\n  gt::gt() |>\n  gt::fmt_scientific(p.value) |>\n  gt::fmt_number(-p.value, decimals=2) |>\n  gt::fmt_integer(df)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"sjiqtmxiss\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#sjiqtmxiss table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#sjiqtmxiss thead, #sjiqtmxiss tbody, #sjiqtmxiss tfoot, #sjiqtmxiss tr, #sjiqtmxiss td, #sjiqtmxiss th {\n  border-style: none;\n}\n\n#sjiqtmxiss p {\n  margin: 0;\n  padding: 0;\n}\n\n#sjiqtmxiss .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#sjiqtmxiss .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#sjiqtmxiss .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#sjiqtmxiss .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#sjiqtmxiss .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#sjiqtmxiss .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#sjiqtmxiss .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#sjiqtmxiss .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#sjiqtmxiss .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#sjiqtmxiss .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#sjiqtmxiss .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#sjiqtmxiss .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#sjiqtmxiss .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#sjiqtmxiss .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#sjiqtmxiss .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#sjiqtmxiss .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#sjiqtmxiss .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#sjiqtmxiss .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#sjiqtmxiss .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#sjiqtmxiss .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#sjiqtmxiss .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#sjiqtmxiss .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#sjiqtmxiss .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#sjiqtmxiss .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#sjiqtmxiss .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#sjiqtmxiss .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#sjiqtmxiss .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#sjiqtmxiss .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#sjiqtmxiss .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#sjiqtmxiss .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#sjiqtmxiss .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#sjiqtmxiss .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#sjiqtmxiss .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#sjiqtmxiss .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#sjiqtmxiss .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#sjiqtmxiss .gt_left {\n  text-align: left;\n}\n\n#sjiqtmxiss .gt_center {\n  text-align: center;\n}\n\n#sjiqtmxiss .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#sjiqtmxiss .gt_font_normal {\n  font-weight: normal;\n}\n\n#sjiqtmxiss .gt_font_bold {\n  font-weight: bold;\n}\n\n#sjiqtmxiss .gt_font_italic {\n  font-style: italic;\n}\n\n#sjiqtmxiss .gt_super {\n  font-size: 65%;\n}\n\n#sjiqtmxiss .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#sjiqtmxiss .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#sjiqtmxiss .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#sjiqtmxiss .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#sjiqtmxiss .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#sjiqtmxiss .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#sjiqtmxiss .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#sjiqtmxiss .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#sjiqtmxiss div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"form\">form</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"r.squared\">r.squared</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"adj.r.squared\">adj.r.squared</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"sigma\">sigma</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"statistic\">statistic</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"p.value\">p.value</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"df\">df</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"form\" class=\"gt_row gt_left\">Gas ~ Insul + Temp</td>\n<td headers=\"r.squared\" class=\"gt_row gt_right\">0.91</td>\n<td headers=\"adj.r.squared\" class=\"gt_row gt_right\">0.91</td>\n<td headers=\"sigma\" class=\"gt_row gt_right\">0.36</td>\n<td headers=\"statistic\" class=\"gt_row gt_right\">267.11</td>\n<td headers=\"p.value\" class=\"gt_row gt_right\">2.09&nbsp;√ó&nbsp;10<sup style='font-size: 65%;'>‚àí28</sup></td>\n<td headers=\"df\" class=\"gt_row gt_right\">2</td></tr>\n    <tr><td headers=\"form\" class=\"gt_row gt_left\">Gas ~ Insul * Temp</td>\n<td headers=\"r.squared\" class=\"gt_row gt_right\">0.93</td>\n<td headers=\"adj.r.squared\" class=\"gt_row gt_right\">0.92</td>\n<td headers=\"sigma\" class=\"gt_row gt_right\">0.32</td>\n<td headers=\"statistic\" class=\"gt_row gt_right\">222.33</td>\n<td headers=\"p.value\" class=\"gt_row gt_right\">1.23&nbsp;√ó&nbsp;10<sup style='font-size: 65%;'>‚àí29</sup></td>\n<td headers=\"df\" class=\"gt_row gt_right\">3</td></tr>\n    <tr><td headers=\"form\" class=\"gt_row gt_left\">Gas ~ Insul * poly(Temp, 5, raw = T)</td>\n<td headers=\"r.squared\" class=\"gt_row gt_right\">0.95</td>\n<td headers=\"adj.r.squared\" class=\"gt_row gt_right\">0.93</td>\n<td headers=\"sigma\" class=\"gt_row gt_right\">0.31</td>\n<td headers=\"statistic\" class=\"gt_row gt_right\">69.12</td>\n<td headers=\"p.value\" class=\"gt_row gt_right\">4.80&nbsp;√ó&nbsp;10<sup style='font-size: 65%;'>‚àí24</sup></td>\n<td headers=\"df\" class=\"gt_row gt_right\">11</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n:::\n\n::: {.callout-note title='Question'} \n \nComment the diagnostic plots for `Gas ~ Insul* poly(Temp, 5, raw=T)`\n\n:::\n\n::: {.content-visible when-profile='solution'} \n \n \n::: {.callout-tip title='Solution'} \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nautoplot(lm_5) \n```\n\n::: {.cell-output-display}\n![](lab-linear-regression-whiteside-2_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\n\n \n:::\n\n\n:::\n\n::: {.callout-note title='Question'} \n \nIn model defined by `Gas ~ Insul* poly(Temp, 5, raw=T)`, which coefficients are deemed to differ significantly from `0` (at level $99\\%$)?\n\n:::\n\n::: {.content-visible when-profile='solution'} \n \n::: {.callout-tip title='Solution'} \n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntbb_confint <- function(lmm, level=.95) {\n  lmm |>\n  confint(level=level) |>\n  as_tibble() |>\n  mutate(coeff=names(coefficients(lmm))) |>\n  relocate(coeff)   \n}\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlm_5 |>\n  tbb_confint(level=.99) |>\n  gt::gt()  |> \n  gt::fmt_scientific(exp_style = \"e1\") |>\n  gt::tab_caption(deparse(formula(lm_5)))\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"ahicquxdxd\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#ahicquxdxd table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#ahicquxdxd thead, #ahicquxdxd tbody, #ahicquxdxd tfoot, #ahicquxdxd tr, #ahicquxdxd td, #ahicquxdxd th {\n  border-style: none;\n}\n\n#ahicquxdxd p {\n  margin: 0;\n  padding: 0;\n}\n\n#ahicquxdxd .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#ahicquxdxd .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#ahicquxdxd .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#ahicquxdxd .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#ahicquxdxd .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ahicquxdxd .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ahicquxdxd .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ahicquxdxd .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#ahicquxdxd .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#ahicquxdxd .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#ahicquxdxd .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#ahicquxdxd .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#ahicquxdxd .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#ahicquxdxd .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#ahicquxdxd .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#ahicquxdxd .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#ahicquxdxd .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#ahicquxdxd .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#ahicquxdxd .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ahicquxdxd .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#ahicquxdxd .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#ahicquxdxd .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#ahicquxdxd .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ahicquxdxd .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#ahicquxdxd .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#ahicquxdxd .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ahicquxdxd .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ahicquxdxd .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#ahicquxdxd .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ahicquxdxd .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#ahicquxdxd .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ahicquxdxd .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ahicquxdxd .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ahicquxdxd .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ahicquxdxd .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ahicquxdxd .gt_left {\n  text-align: left;\n}\n\n#ahicquxdxd .gt_center {\n  text-align: center;\n}\n\n#ahicquxdxd .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#ahicquxdxd .gt_font_normal {\n  font-weight: normal;\n}\n\n#ahicquxdxd .gt_font_bold {\n  font-weight: bold;\n}\n\n#ahicquxdxd .gt_font_italic {\n  font-style: italic;\n}\n\n#ahicquxdxd .gt_super {\n  font-size: 65%;\n}\n\n#ahicquxdxd .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#ahicquxdxd .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#ahicquxdxd .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#ahicquxdxd .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#ahicquxdxd .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#ahicquxdxd .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#ahicquxdxd .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#ahicquxdxd .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#ahicquxdxd div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <caption>Gas ~ Insul * (Insul + Temp_)</caption>\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"coeff\">coeff</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"0.5 %\">0.5 %</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"99.5 %\">99.5 %</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"coeff\" class=\"gt_row gt_left\">(Intercept)</td>\n<td headers=\"0.5 %\" class=\"gt_row gt_right\">5.91e0</td>\n<td headers=\"99.5 %\" class=\"gt_row gt_right\">7.25e0</td></tr>\n    <tr><td headers=\"coeff\" class=\"gt_row gt_left\">InsulAfter</td>\n<td headers=\"0.5 %\" class=\"gt_row gt_right\">‚àí2.62e0</td>\n<td headers=\"99.5 %\" class=\"gt_row gt_right\">‚àí8.77e‚àí1</td></tr>\n    <tr><td headers=\"coeff\" class=\"gt_row gt_left\">Temp_1</td>\n<td headers=\"0.5 %\" class=\"gt_row gt_right\">‚àí1.03e0</td>\n<td headers=\"99.5 %\" class=\"gt_row gt_right\">1.08e‚àí1</td></tr>\n    <tr><td headers=\"coeff\" class=\"gt_row gt_left\">Temp_2</td>\n<td headers=\"0.5 %\" class=\"gt_row gt_right\">‚àí3.74e‚àí1</td>\n<td headers=\"99.5 %\" class=\"gt_row gt_right\">7.38e‚àí1</td></tr>\n    <tr><td headers=\"coeff\" class=\"gt_row gt_left\">Temp_3</td>\n<td headers=\"0.5 %\" class=\"gt_row gt_right\">‚àí2.21e‚àí1</td>\n<td headers=\"99.5 %\" class=\"gt_row gt_right\">1.05e‚àí1</td></tr>\n    <tr><td headers=\"coeff\" class=\"gt_row gt_left\">Temp_4</td>\n<td headers=\"0.5 %\" class=\"gt_row gt_right\">‚àí1.25e‚àí2</td>\n<td headers=\"99.5 %\" class=\"gt_row gt_right\">2.59e‚àí2</td></tr>\n    <tr><td headers=\"coeff\" class=\"gt_row gt_left\">Temp_5</td>\n<td headers=\"0.5 %\" class=\"gt_row gt_right\">‚àí1.06e‚àí3</td>\n<td headers=\"99.5 %\" class=\"gt_row gt_right\">5.19e‚àí4</td></tr>\n    <tr><td headers=\"coeff\" class=\"gt_row gt_left\">InsulAfter:Temp_1</td>\n<td headers=\"0.5 %\" class=\"gt_row gt_right\">‚àí5.82e‚àí1</td>\n<td headers=\"99.5 %\" class=\"gt_row gt_right\">1.02e0</td></tr>\n    <tr><td headers=\"coeff\" class=\"gt_row gt_left\">InsulAfter:Temp_2</td>\n<td headers=\"0.5 %\" class=\"gt_row gt_right\">‚àí1.20e0</td>\n<td headers=\"99.5 %\" class=\"gt_row gt_right\">3.62e‚àí1</td></tr>\n    <tr><td headers=\"coeff\" class=\"gt_row gt_left\">InsulAfter:Temp_3</td>\n<td headers=\"0.5 %\" class=\"gt_row gt_right\">‚àí8.78e‚àí2</td>\n<td headers=\"99.5 %\" class=\"gt_row gt_right\">4.03e‚àí1</td></tr>\n    <tr><td headers=\"coeff\" class=\"gt_row gt_left\">InsulAfter:Temp_4</td>\n<td headers=\"0.5 %\" class=\"gt_row gt_right\">‚àí5.10e‚àí2</td>\n<td headers=\"99.5 %\" class=\"gt_row gt_right\">1.01e‚àí2</td></tr>\n    <tr><td headers=\"coeff\" class=\"gt_row gt_left\">InsulAfter:Temp_5</td>\n<td headers=\"0.5 %\" class=\"gt_row gt_right\">‚àí4.45e‚àí4</td>\n<td headers=\"99.5 %\" class=\"gt_row gt_right\">2.18e‚àí3</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlm_5 |>\n  tbb_confint(level=.95) |> \n  filter(! (`2.5 %` < 0 & 0 < `97.5 %`))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 √ó 3\n  coeff       `2.5 %` `97.5 %`\n  <chr>         <dbl>    <dbl>\n1 (Intercept)   6.07    7.08  \n2 InsulAfter   -2.40   -1.10  \n3 Temp_1       -0.885  -0.0350\n```\n\n\n:::\n:::\n\n\n\n\n\n:::\n\n:::\n\n::: {.callout-note title='Question'} \n\nPick the *best subset solution* \n \n:::\n\n\n::: {.content-visible when-profile='solution'} \n \n::: {.callout-tip title='Solution'} \n \n\n\n\n::: {.cell}\n\n:::\n\n\n\n \n:::\n\n:::\n\n\n::: {.callout-note title='Question'} \n \nUse `stepAIC` from package `MASS` to explore the submodels of `Gas ~ Insul * poly(Temp, 5, raw=T)`.\n\n:::\n\n::: {.content-visible when-profile='solution'} \n \n::: {.callout-tip title='Solution'} \n \n \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlm_5 <- lm(Gas ~ Insul * (Temp + I(Temp^2) + I(Temp^3) + I(Temp^4) + I(Temp^5)), whiteside)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nres <- stepAIC(lm_5, trace=T)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nStart:  AIC=-122.36\nGas ~ Insul * (Temp + I(Temp^2) + I(Temp^3) + I(Temp^4) + I(Temp^5))\n\n                  Df Sum of Sq    RSS     AIC\n- Insul:Temp       1  0.050615 4.1542 -123.67\n<none>                         4.1036 -122.36\n- Insul:I(Temp^2)  1  0.194003 4.2976 -121.77\n- Insul:I(Temp^3)  1  0.279013 4.3826 -120.67\n- Insul:I(Temp^5)  1  0.295019 4.3986 -120.47\n- Insul:I(Temp^4)  1  0.302257 4.4059 -120.38\n\nStep:  AIC=-123.67\nGas ~ Insul + Temp + I(Temp^2) + I(Temp^3) + I(Temp^4) + I(Temp^5) + \n    Insul:I(Temp^2) + Insul:I(Temp^3) + Insul:I(Temp^4) + Insul:I(Temp^5)\n\n                  Df Sum of Sq    RSS     AIC\n<none>                         4.1542 -123.67\n- Insul:I(Temp^2)  1   0.18554 4.3398 -123.22\n- Insul:I(Temp^5)  1   0.24550 4.3997 -122.45\n- Insul:I(Temp^3)  1   0.24925 4.4035 -122.41\n- Insul:I(Temp^4)  1   0.25853 4.4128 -122.29\n- Temp             1   0.51565 4.6699 -119.12\n```\n\n\n:::\n:::\n\n\n\n\n\n:::\n \n:::\n\n\n## Penalized regression\n\n\n::: {.callout-note title='Question'} \n \n \n:::\n\n\n::: {.content-visible when-profile='solution'} \n\n::: {.callout-tip title='Solution'} \n \n \n::: \n \n:::\n\n## Robust regression\n\n::: {.callout-note title='Question'} \n \n \n:::\n\n::: {.content-visible when-profile='solution'} \n \n::: {.callout-tip title='Solution'} \n \n \n:::\n\n:::\n\n\n## Shape constrained inference\n\n\n::: {.callout-note title='Question'} \n \n \n:::\n\n\n::: {.content-visible when-profile='solution'} \n \n::: {.callout-tip title='Solution'} \n \n \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngp_whiteside <- whiteside |>\n  group_by(Insul) |>\n  arrange(Temp, .by_group=T) \n  \nres <- gp_whiteside  |>\n  summarize(gpv=list(- gpava(z=Temp, y=-Gas, ties=\"secondary\")[[\"x\"]]), Temp = list(Temp)) |>\n  unnest(cols=c(gpv, Temp)) \n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ngp_whiteside |>\n  bind_cols(res) |>\n  ggplot() +\n    aes(x=`Temp...2`, group=`Insul...1`) +\n    geom_point(aes(y=`Gas`, shape=`Insul...1`)) +\n    geom_step(aes(y=gpv, linetype=`Insul...1`)) +\n    geom_smooth(aes(y=Gas), formula='y ~ x', method=\"lm\", se=F)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nNew names:\n‚Ä¢ `Insul` -> `Insul...1`\n‚Ä¢ `Temp` -> `Temp...2`\n‚Ä¢ `Insul` -> `Insul...4`\n‚Ä¢ `Temp` -> `Temp...6`\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](lab-linear-regression-whiteside-2_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n:::\n\n\n\n\n:::\n\n\n::: {.callout-tip title='Solution'} \n \n \n:::\n\n:::",
    "supporting": [
      "lab-linear-regression-whiteside-2_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}